# MuJoCo Simulation Configuration
# Module 02: Rigid Body Dynamics

id: sim-02-dynamics
platform: mujoco
robot_model: custom/rigid_bodies.xml
environment: default

# Physics Settings
physics_settings:
  timestep: 0.001          # 1ms timestep (1000 Hz) for accurate dynamics
  gravity: [0, 0, -9.81]   # Earth gravity
  solver_iterations: 100   # Higher iterations for contact accuracy
  contact_model: elliptic
  integrator: Euler        # Options: Euler, RK4

# Contact Parameters
contact_settings:
  condim: 3                # Contact dimensionality (3 = frictionless)
  friction: [0.5, 0.005, 0.0001]  # Tangent, torsional, rolling
  solimp: [0.9, 0.95, 0.001]     # Contact impedance
  solref: [0.02, 1.0]            # Contact reference

# Visualization Settings
visualization:
  camera_position: [2.0, 2.0, 2.0]
  camera_lookat: [0, 0, 0.5]
  render_mode: window
  record_video: false
  show_contact_forces: true
  show_constraint_forces: true

# Recording Settings
recording:
  format: mp4
  fps: 60
  resolution: [1920, 1080]
  output_dir: "recordings/module-02/"

# Entry Points
launch_script: "scripts/launch_sim_02.py"
notebook: "notebooks/02-rigid-body-dynamics.ipynb"
docker_image: "physicalai-textbook/mujoco:3.0"

# Module-Specific Settings
module_config:
  # Scenarios for this module
  scenarios:
    - name: "free_fall"
      description: "Single body falling under gravity"
      model_xml: |
        <mujoco>
          <option gravity="0 0 -9.81" timestep="0.001"/>
          <worldbody>
            <geom type="plane" size="5 5 0.1"/>
            <body name="box" pos="0 0 2">
              <joint type="free"/>
              <geom type="box" size="0.2 0.2 0.2" mass="1.0"/>
            </body>
          </worldbody>
        </mujoco>
      duration: 3.0

    - name: "collision_1d"
      description: "One-dimensional collision between two bodies"
      model_xml: |
        <mujoco>
          <option gravity="0 0 0" timestep="0.0001"/>
          <worldbody>
            <body name="ball1" pos="-1 0 0">
              <joint type="free"/>
              <geom type="sphere" size="0.1" mass="1.0"/>
            </body>
            <body name="ball2" pos="1 0 0">
              <joint type="free"/>
              <geom type="sphere" size="0.1" mass="1.0"/>
            </body>
          </worldbody>
        </mujoco>
      initial_velocities:
        ball1: [2.0, 0, 0, 0, 0, 0]
        ball2: [-1.0, 0, 0, 0, 0, 0]
      duration: 2.0

    - name: "pendulum"
      description: "Simple pendulum for period measurement"
      model_xml: |
        <mujoco>
          <option gravity="0 0 -9.81" timestep="0.001"/>
          <worldbody>
            <body name="pivot" pos="0 0 2">
              <joint name="hinge" type="hinge" axis="0 1 0"/>
              <geom type="sphere" size="0.05" mass="0.01"/>
              <body name="bob" pos="0 0 -1">
                <geom type="sphere" size="0.1" mass="1.0"/>
              </body>
            </body>
          </worldbody>
        </mujoco>
      initial_angle: 0.5  # radians
      duration: 10.0

    - name: "spinning_top"
      description: "Gyroscopic precession demonstration"
      model_xml: |
        <mujoco>
          <option gravity="0 0 -9.81" timestep="0.0005"/>
          <worldbody>
            <geom type="plane" size="2 2 0.1"/>
            <body name="top" pos="0 0 0.5">
              <joint type="free"/>
              <geom type="cylinder" size="0.1 0.02" mass="0.5"/>
              <geom type="cylinder" size="0.01 0.3" pos="0 0 0.15" mass="0.1"/>
            </body>
          </worldbody>
        </mujoco>
      initial_spin: 50.0  # rad/s
      initial_tilt: 0.17  # radians (~10 degrees)
      duration: 10.0

  # Lab exercise mappings
  labs:
    - lab_id: "lab-02-01"
      scenarios: ["free_fall"]
      checkpoints:
        - "verify_gravity"
        - "measure_acceleration"
        - "check_contact_forces"

    - lab_id: "lab-02-02"
      scenarios: ["free_fall", "collision_1d"]
      checkpoints:
        - "energy_conservation"
        - "measure_restitution"
        - "momentum_conservation"

    - lab_id: "lab-02-03"
      scenarios: ["pendulum", "spinning_top"]
      checkpoints:
        - "measure_period"
        - "inertia_measurement"
        - "precession_observation"
