"use strict";(globalThis.webpackChunkmy_book=globalThis.webpackChunkmy_book||[]).push([[9601],{2711(e,n,s){s.r(n),s.d(n,{assets:()=>c,contentTitle:()=>r,default:()=>m,frontMatter:()=>a,metadata:()=>t,toc:()=>o});const t=JSON.parse('{"id":"textbook/modules/locomotion/labs/lab-08-03","title":"Dynamic Locomotion and Running","description":"Objectives","source":"@site/docs/textbook/modules/08-locomotion/labs/lab-08-03.md","sourceDirName":"textbook/modules/08-locomotion/labs","slug":"/textbook/modules/locomotion/labs/lab-08-03","permalink":"/Hackathon-3/docs/textbook/modules/locomotion/labs/lab-08-03","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/textbook/modules/08-locomotion/labs/lab-08-03.md","tags":[],"version":"current","frontMatter":{"id":"lab-08-03","module_id":"08","title":"Dynamic Locomotion and Running","difficulty":"challenge","tier":"simulation","duration_minutes":120},"sidebar":"tutorialSidebar","previous":{"title":"Walking Gait Generation","permalink":"/Hackathon-3/docs/textbook/modules/locomotion/labs/lab-08-02"},"next":{"title":"Locomotion","permalink":"/Hackathon-3/docs/textbook/modules/locomotion/locomotion"}}');var i=s(4848),l=s(8453);const a={id:"lab-08-03",module_id:"08",title:"Dynamic Locomotion and Running",difficulty:"challenge",tier:"simulation",duration_minutes:120},r="Lab 08-03: Dynamic Locomotion and Running",c={},o=[{value:"Objectives",id:"objectives",level:2},{value:"Prerequisites",id:"prerequisites",level:2},{value:"Materials",id:"materials",level:2},{value:"Background",id:"background",level:2},{value:"Running vs. Walking",id:"running-vs-walking",level:3},{value:"Spring-Loaded Inverted Pendulum (SLIP)",id:"spring-loaded-inverted-pendulum-slip",level:3},{value:"Raibert Hopping Controller",id:"raibert-hopping-controller",level:3},{value:"Instructions",id:"instructions",level:2},{value:"Step 1: Implement SLIP Model",id:"step-1-implement-slip-model",level:3},{value:"Step 2: Design Raibert Controller",id:"step-2-design-raibert-controller",level:3},{value:"Step 3: Implement Flight Phase Control",id:"step-3-implement-flight-phase-control",level:3},{value:"Step 4: Energy Analysis",id:"step-4-energy-analysis",level:3},{value:"Step 5: Compare Walking vs Running",id:"step-5-compare-walking-vs-running",level:3},{value:"Step 6: MuJoCo Running Simulation",id:"step-6-mujoco-running-simulation",level:3},{value:"Expected Outcomes",id:"expected-outcomes",level:2},{value:"Rubric",id:"rubric",level:2},{value:"Common Errors",id:"common-errors",level:2},{value:"Extensions",id:"extensions",level:2},{value:"Related Content",id:"related-content",level:2}];function d(e){const n={annotation:"annotation",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",input:"input",li:"li",math:"math",mfrac:"mfrac",mi:"mi",mn:"mn",mo:"mo",mover:"mover",mrow:"mrow",msqrt:"msqrt",msub:"msub",msup:"msup",ol:"ol",p:"p",path:"path",pre:"pre",semantics:"semantics",span:"span",strong:"strong",svg:"svg",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,l.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"lab-08-03-dynamic-locomotion-and-running",children:"Lab 08-03: Dynamic Locomotion and Running"})}),"\n",(0,i.jsx)(n.h2,{id:"objectives",children:"Objectives"}),"\n",(0,i.jsx)(n.p,{children:"By the end of this lab, you will be able to:"}),"\n",(0,i.jsxs)(n.ul,{className:"contains-task-list",children:["\n",(0,i.jsxs)(n.li,{className:"task-list-item",children:[(0,i.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Implement Spring-Loaded Inverted Pendulum (SLIP) model for running"]}),"\n",(0,i.jsxs)(n.li,{className:"task-list-item",children:[(0,i.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Design flight phase controllers for aerial locomotion"]}),"\n",(0,i.jsxs)(n.li,{className:"task-list-item",children:[(0,i.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Generate and track running gaits with touchdown control"]}),"\n",(0,i.jsxs)(n.li,{className:"task-list-item",children:[(0,i.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Analyze energy efficiency of different locomotion modes"]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"prerequisites",children:"Prerequisites"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Completed Labs 08-01 and 08-02"}),"\n",(0,i.jsx)(n.li,{children:"Understanding of hybrid dynamical systems"}),"\n",(0,i.jsx)(n.li,{children:"Familiarity with energy-based control concepts"}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"materials",children:"Materials"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Type"}),(0,i.jsx)(n.th,{children:"Name"}),(0,i.jsx)(n.th,{children:"Tier"}),(0,i.jsx)(n.th,{children:"Notes"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"software"}),(0,i.jsx)(n.td,{children:"MuJoCo 3.0+"}),(0,i.jsx)(n.td,{children:"required"}),(0,i.jsx)(n.td,{children:"Physics simulation"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"software"}),(0,i.jsx)(n.td,{children:"Python 3.10+"}),(0,i.jsx)(n.td,{children:"required"}),(0,i.jsx)(n.td,{children:"Programming environment"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"software"}),(0,i.jsx)(n.td,{children:"NumPy, SciPy"}),(0,i.jsx)(n.td,{children:"required"}),(0,i.jsx)(n.td,{children:"ODE integration, optimization"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"simulation"}),(0,i.jsx)(n.td,{children:"slip-runner.xml"}),(0,i.jsx)(n.td,{children:"required"}),(0,i.jsx)(n.td,{children:"SLIP model for running"})]})]})]}),"\n",(0,i.jsx)(n.h2,{id:"background",children:"Background"}),"\n",(0,i.jsx)(n.h3,{id:"running-vs-walking",children:"Running vs. Walking"}),"\n",(0,i.jsx)(n.p,{children:"Walking: Always at least one foot on ground (no flight phase)\nRunning: Includes flight phase where no feet touch ground"}),"\n",(0,i.jsx)(n.h3,{id:"spring-loaded-inverted-pendulum-slip",children:"Spring-Loaded Inverted Pendulum (SLIP)"}),"\n",(0,i.jsx)(n.p,{children:"The SLIP model captures essential running dynamics:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Point mass at hip"}),"\n",(0,i.jsx)(n.li,{children:"Massless spring leg"}),"\n",(0,i.jsx)(n.li,{children:"Two phases: stance and flight"}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Stance dynamics:"}),"\n",(0,i.jsxs)(n.span,{className:"katex",children:[(0,i.jsx)(n.span,{className:"katex-mathml",children:(0,i.jsx)(n.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,i.jsxs)(n.semantics,{children:[(0,i.jsxs)(n.mrow,{children:[(0,i.jsx)(n.mi,{children:"m"}),(0,i.jsxs)(n.mover,{accent:"true",children:[(0,i.jsx)(n.mi,{children:"x"}),(0,i.jsx)(n.mo,{children:"\xa8"})]}),(0,i.jsx)(n.mo,{children:"="}),(0,i.jsx)(n.mo,{children:"\u2212"}),(0,i.jsx)(n.mi,{children:"k"}),(0,i.jsx)(n.mo,{stretchy:"false",children:"("}),(0,i.jsx)(n.mi,{children:"r"}),(0,i.jsx)(n.mo,{children:"\u2212"}),(0,i.jsxs)(n.msub,{children:[(0,i.jsx)(n.mi,{children:"r"}),(0,i.jsx)(n.mn,{children:"0"})]}),(0,i.jsx)(n.mo,{stretchy:"false",children:")"}),(0,i.jsxs)(n.mfrac,{children:[(0,i.jsxs)(n.mrow,{children:[(0,i.jsx)(n.mi,{children:"x"}),(0,i.jsx)(n.mo,{children:"\u2212"}),(0,i.jsxs)(n.msub,{children:[(0,i.jsx)(n.mi,{children:"x"}),(0,i.jsx)(n.mi,{children:"f"})]})]}),(0,i.jsx)(n.mi,{children:"r"})]})]}),(0,i.jsx)(n.annotation,{encoding:"application/x-tex",children:"m\\ddot{x} = -k(r - r_0)\\frac{x - x_f}{r}"})]})})}),(0,i.jsxs)(n.span,{className:"katex-html","aria-hidden":"true",children:[(0,i.jsxs)(n.span,{className:"base",children:[(0,i.jsx)(n.span,{className:"strut",style:{height:"0.6679em"}}),(0,i.jsx)(n.span,{className:"mord mathnormal",children:"m"}),(0,i.jsx)(n.span,{className:"mord accent",children:(0,i.jsx)(n.span,{className:"vlist-t",children:(0,i.jsx)(n.span,{className:"vlist-r",children:(0,i.jsxs)(n.span,{className:"vlist",style:{height:"0.6679em"},children:[(0,i.jsxs)(n.span,{style:{top:"-3em"},children:[(0,i.jsx)(n.span,{className:"pstrut",style:{height:"3em"}}),(0,i.jsx)(n.span,{className:"mord mathnormal",children:"x"})]}),(0,i.jsxs)(n.span,{style:{top:"-3em"},children:[(0,i.jsx)(n.span,{className:"pstrut",style:{height:"3em"}}),(0,i.jsx)(n.span,{className:"accent-body",style:{left:"-0.2222em"},children:(0,i.jsx)(n.span,{className:"mord",children:"\xa8"})})]})]})})})}),(0,i.jsx)(n.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,i.jsx)(n.span,{className:"mrel",children:"="}),(0,i.jsx)(n.span,{className:"mspace",style:{marginRight:"0.2778em"}})]}),(0,i.jsxs)(n.span,{className:"base",children:[(0,i.jsx)(n.span,{className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,i.jsx)(n.span,{className:"mord",children:"\u2212"}),(0,i.jsx)(n.span,{className:"mord mathnormal",style:{marginRight:"0.03148em"},children:"k"}),(0,i.jsx)(n.span,{className:"mopen",children:"("}),(0,i.jsx)(n.span,{className:"mord mathnormal",style:{marginRight:"0.02778em"},children:"r"}),(0,i.jsx)(n.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,i.jsx)(n.span,{className:"mbin",children:"\u2212"}),(0,i.jsx)(n.span,{className:"mspace",style:{marginRight:"0.2222em"}})]}),(0,i.jsxs)(n.span,{className:"base",children:[(0,i.jsx)(n.span,{className:"strut",style:{height:"1.2664em",verticalAlign:"-0.345em"}}),(0,i.jsxs)(n.span,{className:"mord",children:[(0,i.jsx)(n.span,{className:"mord mathnormal",style:{marginRight:"0.02778em"},children:"r"}),(0,i.jsx)(n.span,{className:"msupsub",children:(0,i.jsxs)(n.span,{className:"vlist-t vlist-t2",children:[(0,i.jsxs)(n.span,{className:"vlist-r",children:[(0,i.jsx)(n.span,{className:"vlist",style:{height:"0.3011em"},children:(0,i.jsxs)(n.span,{style:{top:"-2.55em",marginLeft:"-0.0278em",marginRight:"0.05em"},children:[(0,i.jsx)(n.span,{className:"pstrut",style:{height:"2.7em"}}),(0,i.jsx)(n.span,{className:"sizing reset-size6 size3 mtight",children:(0,i.jsx)(n.span,{className:"mord mtight",children:"0"})})]})}),(0,i.jsx)(n.span,{className:"vlist-s",children:"\u200b"})]}),(0,i.jsx)(n.span,{className:"vlist-r",children:(0,i.jsx)(n.span,{className:"vlist",style:{height:"0.15em"},children:(0,i.jsx)(n.span,{})})})]})})]}),(0,i.jsx)(n.span,{className:"mclose",children:")"}),(0,i.jsxs)(n.span,{className:"mord",children:[(0,i.jsx)(n.span,{className:"mopen nulldelimiter"}),(0,i.jsx)(n.span,{className:"mfrac",children:(0,i.jsxs)(n.span,{className:"vlist-t vlist-t2",children:[(0,i.jsxs)(n.span,{className:"vlist-r",children:[(0,i.jsxs)(n.span,{className:"vlist",style:{height:"0.9214em"},children:[(0,i.jsxs)(n.span,{style:{top:"-2.655em"},children:[(0,i.jsx)(n.span,{className:"pstrut",style:{height:"3em"}}),(0,i.jsx)(n.span,{className:"sizing reset-size6 size3 mtight",children:(0,i.jsx)(n.span,{className:"mord mtight",children:(0,i.jsx)(n.span,{className:"mord mathnormal mtight",style:{marginRight:"0.02778em"},children:"r"})})})]}),(0,i.jsxs)(n.span,{style:{top:"-3.23em"},children:[(0,i.jsx)(n.span,{className:"pstrut",style:{height:"3em"}}),(0,i.jsx)(n.span,{className:"frac-line",style:{borderBottomWidth:"0.04em"}})]}),(0,i.jsxs)(n.span,{style:{top:"-3.5131em"},children:[(0,i.jsx)(n.span,{className:"pstrut",style:{height:"3em"}}),(0,i.jsx)(n.span,{className:"sizing reset-size6 size3 mtight",children:(0,i.jsxs)(n.span,{className:"mord mtight",children:[(0,i.jsx)(n.span,{className:"mord mathnormal mtight",children:"x"}),(0,i.jsx)(n.span,{className:"mbin mtight",children:"\u2212"}),(0,i.jsxs)(n.span,{className:"mord mtight",children:[(0,i.jsx)(n.span,{className:"mord mathnormal mtight",children:"x"}),(0,i.jsx)(n.span,{className:"msupsub",children:(0,i.jsxs)(n.span,{className:"vlist-t vlist-t2",children:[(0,i.jsxs)(n.span,{className:"vlist-r",children:[(0,i.jsx)(n.span,{className:"vlist",style:{height:"0.3448em"},children:(0,i.jsxs)(n.span,{style:{top:"-2.3488em",marginLeft:"0em",marginRight:"0.0714em"},children:[(0,i.jsx)(n.span,{className:"pstrut",style:{height:"2.5em"}}),(0,i.jsx)(n.span,{className:"sizing reset-size3 size1 mtight",children:(0,i.jsx)(n.span,{className:"mord mathnormal mtight",style:{marginRight:"0.10764em"},children:"f"})})]})}),(0,i.jsx)(n.span,{className:"vlist-s",children:"\u200b"})]}),(0,i.jsx)(n.span,{className:"vlist-r",children:(0,i.jsx)(n.span,{className:"vlist",style:{height:"0.2901em"},children:(0,i.jsx)(n.span,{})})})]})})]})]})})]})]}),(0,i.jsx)(n.span,{className:"vlist-s",children:"\u200b"})]}),(0,i.jsx)(n.span,{className:"vlist-r",children:(0,i.jsx)(n.span,{className:"vlist",style:{height:"0.345em"},children:(0,i.jsx)(n.span,{})})})]})}),(0,i.jsx)(n.span,{className:"mclose nulldelimiter"})]})]})]})]}),"\n",(0,i.jsxs)(n.span,{className:"katex",children:[(0,i.jsx)(n.span,{className:"katex-mathml",children:(0,i.jsx)(n.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,i.jsxs)(n.semantics,{children:[(0,i.jsxs)(n.mrow,{children:[(0,i.jsx)(n.mi,{children:"m"}),(0,i.jsxs)(n.mover,{accent:"true",children:[(0,i.jsx)(n.mi,{children:"z"}),(0,i.jsx)(n.mo,{children:"\xa8"})]}),(0,i.jsx)(n.mo,{children:"="}),(0,i.jsx)(n.mo,{children:"\u2212"}),(0,i.jsx)(n.mi,{children:"k"}),(0,i.jsx)(n.mo,{stretchy:"false",children:"("}),(0,i.jsx)(n.mi,{children:"r"}),(0,i.jsx)(n.mo,{children:"\u2212"}),(0,i.jsxs)(n.msub,{children:[(0,i.jsx)(n.mi,{children:"r"}),(0,i.jsx)(n.mn,{children:"0"})]}),(0,i.jsx)(n.mo,{stretchy:"false",children:")"}),(0,i.jsxs)(n.mfrac,{children:[(0,i.jsx)(n.mi,{children:"z"}),(0,i.jsx)(n.mi,{children:"r"})]}),(0,i.jsx)(n.mo,{children:"\u2212"}),(0,i.jsx)(n.mi,{children:"m"}),(0,i.jsx)(n.mi,{children:"g"})]}),(0,i.jsx)(n.annotation,{encoding:"application/x-tex",children:"m\\ddot{z} = -k(r - r_0)\\frac{z}{r} - mg"})]})})}),(0,i.jsxs)(n.span,{className:"katex-html","aria-hidden":"true",children:[(0,i.jsxs)(n.span,{className:"base",children:[(0,i.jsx)(n.span,{className:"strut",style:{height:"0.6679em"}}),(0,i.jsx)(n.span,{className:"mord mathnormal",children:"m"}),(0,i.jsx)(n.span,{className:"mord accent",children:(0,i.jsx)(n.span,{className:"vlist-t",children:(0,i.jsx)(n.span,{className:"vlist-r",children:(0,i.jsxs)(n.span,{className:"vlist",style:{height:"0.6679em"},children:[(0,i.jsxs)(n.span,{style:{top:"-3em"},children:[(0,i.jsx)(n.span,{className:"pstrut",style:{height:"3em"}}),(0,i.jsx)(n.span,{className:"mord mathnormal",style:{marginRight:"0.04398em"},children:"z"})]}),(0,i.jsxs)(n.span,{style:{top:"-3em"},children:[(0,i.jsx)(n.span,{className:"pstrut",style:{height:"3em"}}),(0,i.jsx)(n.span,{className:"accent-body",style:{left:"-0.1944em"},children:(0,i.jsx)(n.span,{className:"mord",children:"\xa8"})})]})]})})})}),(0,i.jsx)(n.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,i.jsx)(n.span,{className:"mrel",children:"="}),(0,i.jsx)(n.span,{className:"mspace",style:{marginRight:"0.2778em"}})]}),(0,i.jsxs)(n.span,{className:"base",children:[(0,i.jsx)(n.span,{className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,i.jsx)(n.span,{className:"mord",children:"\u2212"}),(0,i.jsx)(n.span,{className:"mord mathnormal",style:{marginRight:"0.03148em"},children:"k"}),(0,i.jsx)(n.span,{className:"mopen",children:"("}),(0,i.jsx)(n.span,{className:"mord mathnormal",style:{marginRight:"0.02778em"},children:"r"}),(0,i.jsx)(n.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,i.jsx)(n.span,{className:"mbin",children:"\u2212"}),(0,i.jsx)(n.span,{className:"mspace",style:{marginRight:"0.2222em"}})]}),(0,i.jsxs)(n.span,{className:"base",children:[(0,i.jsx)(n.span,{className:"strut",style:{height:"1.095em",verticalAlign:"-0.345em"}}),(0,i.jsxs)(n.span,{className:"mord",children:[(0,i.jsx)(n.span,{className:"mord mathnormal",style:{marginRight:"0.02778em"},children:"r"}),(0,i.jsx)(n.span,{className:"msupsub",children:(0,i.jsxs)(n.span,{className:"vlist-t vlist-t2",children:[(0,i.jsxs)(n.span,{className:"vlist-r",children:[(0,i.jsx)(n.span,{className:"vlist",style:{height:"0.3011em"},children:(0,i.jsxs)(n.span,{style:{top:"-2.55em",marginLeft:"-0.0278em",marginRight:"0.05em"},children:[(0,i.jsx)(n.span,{className:"pstrut",style:{height:"2.7em"}}),(0,i.jsx)(n.span,{className:"sizing reset-size6 size3 mtight",children:(0,i.jsx)(n.span,{className:"mord mtight",children:"0"})})]})}),(0,i.jsx)(n.span,{className:"vlist-s",children:"\u200b"})]}),(0,i.jsx)(n.span,{className:"vlist-r",children:(0,i.jsx)(n.span,{className:"vlist",style:{height:"0.15em"},children:(0,i.jsx)(n.span,{})})})]})})]}),(0,i.jsx)(n.span,{className:"mclose",children:")"}),(0,i.jsxs)(n.span,{className:"mord",children:[(0,i.jsx)(n.span,{className:"mopen nulldelimiter"}),(0,i.jsx)(n.span,{className:"mfrac",children:(0,i.jsxs)(n.span,{className:"vlist-t vlist-t2",children:[(0,i.jsxs)(n.span,{className:"vlist-r",children:[(0,i.jsxs)(n.span,{className:"vlist",style:{height:"0.6954em"},children:[(0,i.jsxs)(n.span,{style:{top:"-2.655em"},children:[(0,i.jsx)(n.span,{className:"pstrut",style:{height:"3em"}}),(0,i.jsx)(n.span,{className:"sizing reset-size6 size3 mtight",children:(0,i.jsx)(n.span,{className:"mord mtight",children:(0,i.jsx)(n.span,{className:"mord mathnormal mtight",style:{marginRight:"0.02778em"},children:"r"})})})]}),(0,i.jsxs)(n.span,{style:{top:"-3.23em"},children:[(0,i.jsx)(n.span,{className:"pstrut",style:{height:"3em"}}),(0,i.jsx)(n.span,{className:"frac-line",style:{borderBottomWidth:"0.04em"}})]}),(0,i.jsxs)(n.span,{style:{top:"-3.394em"},children:[(0,i.jsx)(n.span,{className:"pstrut",style:{height:"3em"}}),(0,i.jsx)(n.span,{className:"sizing reset-size6 size3 mtight",children:(0,i.jsx)(n.span,{className:"mord mtight",children:(0,i.jsx)(n.span,{className:"mord mathnormal mtight",style:{marginRight:"0.04398em"},children:"z"})})})]})]}),(0,i.jsx)(n.span,{className:"vlist-s",children:"\u200b"})]}),(0,i.jsx)(n.span,{className:"vlist-r",children:(0,i.jsx)(n.span,{className:"vlist",style:{height:"0.345em"},children:(0,i.jsx)(n.span,{})})})]})}),(0,i.jsx)(n.span,{className:"mclose nulldelimiter"})]}),(0,i.jsx)(n.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,i.jsx)(n.span,{className:"mbin",children:"\u2212"}),(0,i.jsx)(n.span,{className:"mspace",style:{marginRight:"0.2222em"}})]}),(0,i.jsxs)(n.span,{className:"base",children:[(0,i.jsx)(n.span,{className:"strut",style:{height:"0.625em",verticalAlign:"-0.1944em"}}),(0,i.jsx)(n.span,{className:"mord mathnormal",children:"m"}),(0,i.jsx)(n.span,{className:"mord mathnormal",style:{marginRight:"0.03588em"},children:"g"})]})]})]})]}),"\n",(0,i.jsxs)(n.p,{children:["Where ",(0,i.jsxs)(n.span,{className:"katex",children:[(0,i.jsx)(n.span,{className:"katex-mathml",children:(0,i.jsx)(n.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,i.jsxs)(n.semantics,{children:[(0,i.jsxs)(n.mrow,{children:[(0,i.jsx)(n.mi,{children:"r"}),(0,i.jsx)(n.mo,{children:"="}),(0,i.jsx)(n.msqrt,{children:(0,i.jsxs)(n.mrow,{children:[(0,i.jsx)(n.mo,{stretchy:"false",children:"("}),(0,i.jsx)(n.mi,{children:"x"}),(0,i.jsx)(n.mo,{children:"\u2212"}),(0,i.jsxs)(n.msub,{children:[(0,i.jsx)(n.mi,{children:"x"}),(0,i.jsx)(n.mi,{children:"f"})]}),(0,i.jsxs)(n.msup,{children:[(0,i.jsx)(n.mo,{stretchy:"false",children:")"}),(0,i.jsx)(n.mn,{children:"2"})]}),(0,i.jsx)(n.mo,{children:"+"}),(0,i.jsxs)(n.msup,{children:[(0,i.jsx)(n.mi,{children:"z"}),(0,i.jsx)(n.mn,{children:"2"})]})]})})]}),(0,i.jsx)(n.annotation,{encoding:"application/x-tex",children:"r = \\sqrt{(x-x_f)^2 + z^2}"})]})})}),(0,i.jsxs)(n.span,{className:"katex-html","aria-hidden":"true",children:[(0,i.jsxs)(n.span,{className:"base",children:[(0,i.jsx)(n.span,{className:"strut",style:{height:"0.4306em"}}),(0,i.jsx)(n.span,{className:"mord mathnormal",style:{marginRight:"0.02778em"},children:"r"}),(0,i.jsx)(n.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,i.jsx)(n.span,{className:"mrel",children:"="}),(0,i.jsx)(n.span,{className:"mspace",style:{marginRight:"0.2778em"}})]}),(0,i.jsxs)(n.span,{className:"base",children:[(0,i.jsx)(n.span,{className:"strut",style:{height:"1.24em",verticalAlign:"-0.3231em"}}),(0,i.jsx)(n.span,{className:"mord sqrt",children:(0,i.jsxs)(n.span,{className:"vlist-t vlist-t2",children:[(0,i.jsxs)(n.span,{className:"vlist-r",children:[(0,i.jsxs)(n.span,{className:"vlist",style:{height:"0.9169em"},children:[(0,i.jsxs)(n.span,{className:"svg-align",style:{top:"-3.2em"},children:[(0,i.jsx)(n.span,{className:"pstrut",style:{height:"3.2em"}}),(0,i.jsxs)(n.span,{className:"mord",style:{paddingLeft:"1em"},children:[(0,i.jsx)(n.span,{className:"mopen",children:"("}),(0,i.jsx)(n.span,{className:"mord mathnormal",children:"x"}),(0,i.jsx)(n.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,i.jsx)(n.span,{className:"mbin",children:"\u2212"}),(0,i.jsx)(n.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,i.jsxs)(n.span,{className:"mord",children:[(0,i.jsx)(n.span,{className:"mord mathnormal",children:"x"}),(0,i.jsx)(n.span,{className:"msupsub",children:(0,i.jsxs)(n.span,{className:"vlist-t vlist-t2",children:[(0,i.jsxs)(n.span,{className:"vlist-r",children:[(0,i.jsx)(n.span,{className:"vlist",style:{height:"0.3361em"},children:(0,i.jsxs)(n.span,{style:{top:"-2.55em",marginLeft:"0em",marginRight:"0.05em"},children:[(0,i.jsx)(n.span,{className:"pstrut",style:{height:"2.7em"}}),(0,i.jsx)(n.span,{className:"sizing reset-size6 size3 mtight",children:(0,i.jsx)(n.span,{className:"mord mathnormal mtight",style:{marginRight:"0.10764em"},children:"f"})})]})}),(0,i.jsx)(n.span,{className:"vlist-s",children:"\u200b"})]}),(0,i.jsx)(n.span,{className:"vlist-r",children:(0,i.jsx)(n.span,{className:"vlist",style:{height:"0.2861em"},children:(0,i.jsx)(n.span,{})})})]})})]}),(0,i.jsxs)(n.span,{className:"mclose",children:[(0,i.jsx)(n.span,{className:"mclose",children:")"}),(0,i.jsx)(n.span,{className:"msupsub",children:(0,i.jsx)(n.span,{className:"vlist-t",children:(0,i.jsx)(n.span,{className:"vlist-r",children:(0,i.jsx)(n.span,{className:"vlist",style:{height:"0.7401em"},children:(0,i.jsxs)(n.span,{style:{top:"-2.989em",marginRight:"0.05em"},children:[(0,i.jsx)(n.span,{className:"pstrut",style:{height:"2.7em"}}),(0,i.jsx)(n.span,{className:"sizing reset-size6 size3 mtight",children:(0,i.jsx)(n.span,{className:"mord mtight",children:"2"})})]})})})})})]}),(0,i.jsx)(n.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,i.jsx)(n.span,{className:"mbin",children:"+"}),(0,i.jsx)(n.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,i.jsxs)(n.span,{className:"mord",children:[(0,i.jsx)(n.span,{className:"mord mathnormal",style:{marginRight:"0.04398em"},children:"z"}),(0,i.jsx)(n.span,{className:"msupsub",children:(0,i.jsx)(n.span,{className:"vlist-t",children:(0,i.jsx)(n.span,{className:"vlist-r",children:(0,i.jsx)(n.span,{className:"vlist",style:{height:"0.7401em"},children:(0,i.jsxs)(n.span,{style:{top:"-2.989em",marginRight:"0.05em"},children:[(0,i.jsx)(n.span,{className:"pstrut",style:{height:"2.7em"}}),(0,i.jsx)(n.span,{className:"sizing reset-size6 size3 mtight",children:(0,i.jsx)(n.span,{className:"mord mtight",children:"2"})})]})})})})})]})]})]}),(0,i.jsxs)(n.span,{style:{top:"-2.8769em"},children:[(0,i.jsx)(n.span,{className:"pstrut",style:{height:"3.2em"}}),(0,i.jsx)(n.span,{className:"hide-tail",style:{minWidth:"1.02em",height:"1.28em"},children:(0,i.jsx)(n.svg,{xmlns:"http://www.w3.org/2000/svg",width:"400em",height:"1.28em",viewBox:"0 0 400000 1296",preserveAspectRatio:"xMinYMin slice",children:(0,i.jsx)(n.path,{d:"M263,681c0.7,0,18,39.7,52,119\nc34,79.3,68.167,158.7,102.5,238c34.3,79.3,51.8,119.3,52.5,120\nc340,-704.7,510.7,-1060.3,512,-1067\nl0 -0\nc4.7,-7.3,11,-11,19,-11\nH40000v40H1012.3\ns-271.3,567,-271.3,567c-38.7,80.7,-84,175,-136,283c-52,108,-89.167,185.3,-111.5,232\nc-22.3,46.7,-33.8,70.3,-34.5,71c-4.7,4.7,-12.3,7,-23,7s-12,-1,-12,-1\ns-109,-253,-109,-253c-72.7,-168,-109.3,-252,-110,-252c-10.7,8,-22,16.7,-34,26\nc-22,17.3,-33.3,26,-34,26s-26,-26,-26,-26s76,-59,76,-59s76,-60,76,-60z\nM1001 80h400000v40h-400000z"})})})]})]}),(0,i.jsx)(n.span,{className:"vlist-s",children:"\u200b"})]}),(0,i.jsx)(n.span,{className:"vlist-r",children:(0,i.jsx)(n.span,{className:"vlist",style:{height:"0.3231em"},children:(0,i.jsx)(n.span,{})})})]})})]})]})]})," is leg length."]}),"\n",(0,i.jsx)(n.h3,{id:"raibert-hopping-controller",children:"Raibert Hopping Controller"}),"\n",(0,i.jsx)(n.p,{children:"Decomposed control:"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Vertical hopping"}),": Control apex height"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Forward speed"}),": Control touchdown angle"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Body attitude"}),": Separate from legs"]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"instructions",children:"Instructions"}),"\n",(0,i.jsx)(n.h3,{id:"step-1-implement-slip-model",children:"Step 1: Implement SLIP Model"}),"\n",(0,i.jsx)(n.p,{children:"Create the SLIP dynamics model:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:'import numpy as np\nfrom scipy.integrate import solve_ivp\nimport matplotlib.pyplot as plt\n\nclass SLIPModel:\n    """Spring-Loaded Inverted Pendulum model for running."""\n\n    def __init__(self, mass=80, leg_length=1.0, stiffness=15000, gravity=9.81):\n        """\n        Initialize SLIP model.\n\n        Args:\n            mass: Body mass (kg)\n            leg_length: Rest leg length (m)\n            stiffness: Leg spring stiffness (N/m)\n            gravity: Gravitational acceleration (m/s^2)\n        """\n        self.m = mass\n        self.r0 = leg_length\n        self.k = stiffness\n        self.g = gravity\n\n        # State: [x, z, xdot, zdot]\n        # Phase: \'flight\' or \'stance\'\n        self.phase = \'flight\'\n        self.foot_x = 0  # Foot position during stance\n\n    def flight_dynamics(self, t, state):\n        """\n        Flight phase dynamics: ballistic motion.\n\n        state = [x, z, xdot, zdot]\n        """\n        x, z, xdot, zdot = state\n        return [xdot, zdot, 0, -self.g]\n\n    def stance_dynamics(self, t, state):\n        """\n        Stance phase dynamics: spring leg.\n\n        state = [x, z, xdot, zdot]\n        """\n        x, z, xdot, zdot = state\n\n        # Leg vector\n        dx = x - self.foot_x\n        r = np.sqrt(dx**2 + z**2)\n\n        # Spring force (compression only)\n```python\n```python\n        if r < self.r0:\n'})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:'            F_spring = self.k * (self.r0 - r)\n        else:\n            F_spring = 0\n\n        # Force components\n        Fx = F_spring * dx / r\n        Fz = F_spring * z / r\n\n        # Accelerations\n        xddot = Fx / self.m\n        zddot = Fz / self.m - self.g\n\n        return [xdot, zdot, xddot, zddot]\n\n    def touchdown_event(self, t, state):\n        """Detect touchdown (z = r0 * cos(angle))."""\n        x, z, xdot, zdot = state\n        # Assuming touchdown at angle theta from vertical\n        # For now, trigger at z = 0.95 * r0 (slightly compressed)\n        return z - 0.95 * self.r0\n\n    def liftoff_event(self, t, state):\n        """Detect liftoff (spring unloaded)."""\n        x, z, xdot, zdot = state\n        dx = x - self.foot_x\n        r = np.sqrt(dx**2 + z**2)\n        return r - self.r0  # Positive when leg fully extended\n\n    def simulate_step(self, state0, touchdown_angle, max_time=2.0):\n        """\n        Simulate one running step.\n\n        Args:\n            state0: Initial state [x, z, xdot, zdot]\n            touchdown_angle: Leg angle at touchdown (rad from vertical)\n            max_time: Maximum simulation time\n\n        Returns:\n            t: Time array\n            states: State array\n            events: Dictionary of event times\n        """\n        t_all = [0]\n        states_all = [state0]\n        events = {}\n\n        state = state0.copy()\n        t_current = 0\n\n        # Phase 1: Flight until touchdown\n```python\n```python\n        if self.phase == \'flight\':\n'})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"            touchdown_event = lambda t, s: s[1] - self.r0 * np.cos(touchdown_angle)\n            touchdown_event.terminal = True\n            touchdown_event.direction = -1\n\n            sol = solve_ivp(\n                self.flight_dynamics,\n                [t_current, t_current + max_time],\n                state,\n                events=touchdown_event,\n                dense_output=True,\n                max_step=0.01\n            )\n\n```python\n```python\n            if sol.t_events[0].size > 0:\n"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"                t_td = sol.t_events[0][0]\n                events['touchdown'] = t_td\n\n                # Record trajectory\n                t_all.extend(sol.t[1:])\n                states_all.extend(sol.y[:, 1:].T.tolist())\n\n                # Update state and foot position\n                state = sol.y_events[0][0]\n                self.foot_x = state[0] - self.r0 * np.sin(touchdown_angle)\n                self.phase = 'stance'\n                t_current = t_td\n            else:\n                # No touchdown\n                t_all.extend(sol.t[1:])\n                states_all.extend(sol.y[:, 1:].T.tolist())\n                return np.array(t_all), np.array(states_all), events\n\n        # Phase 2: Stance until liftoff\n```python\n```python\n        if self.phase == 'stance':\n"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"            liftoff_event = lambda t, s: np.sqrt((s[0]-self.foot_x)**2 + s[1]**2) - self.r0\n            liftoff_event.terminal = True\n            liftoff_event.direction = 1\n\n            sol = solve_ivp(\n                self.stance_dynamics,\n                [t_current, t_current + max_time - (t_current if t_current > 0 else 0)],\n                state,\n                events=liftoff_event,\n                dense_output=True,\n                max_step=0.001  # Smaller for stance accuracy\n            )\n\n```python\n```python\n            if sol.t_events[0].size > 0:\n"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"                t_lo = sol.t_events[0][0]\n                events['liftoff'] = t_lo\n\n                t_all.extend(sol.t[1:])\n                states_all.extend(sol.y[:, 1:].T.tolist())\n\n                state = sol.y_events[0][0]\n                self.phase = 'flight'\n            else:\n                t_all.extend(sol.t[1:])\n                states_all.extend(sol.y[:, 1:].T.tolist())\n\n        return np.array(t_all), np.array(states_all), events\n\n# Create SLIP model\nslip = SLIPModel(mass=80, leg_length=1.0, stiffness=20000)\n\n# Initial state for running\nx0 = 0.0\nz0 = 1.2  # Start above ground\nxdot0 = 3.0  # Forward velocity\nzdot0 = 0.0  # No initial vertical velocity\n\nstate0 = [x0, z0, xdot0, zdot0]\ntouchdown_angle = 0.3  # About 17 degrees forward\n\n# Simulate one step\nslip.phase = 'flight'\nt, states, events = slip.simulate_step(state0, touchdown_angle)\n\nprint(f\"Step simulation: {len(t)} points\")\nprint(f\"Events: {events}\")\nprint(f\"Final state: {states[-1]}\")\n"})}),"\n",(0,i.jsx)("checkpoint",{children:(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Expected"}),": SLIP step simulated with touchdown and liftoff events detected."]})}),"\n",(0,i.jsx)(n.h3,{id:"step-2-design-raibert-controller",children:"Step 2: Design Raibert Controller"}),"\n",(0,i.jsx)(n.p,{children:"Implement the classic Raibert hopping controller:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"class RaibertController:\n    \"\"\"Raibert-style controller for SLIP running.\"\"\"\n\n    def __init__(self, slip_model, desired_speed=3.0, desired_height=1.1):\n        \"\"\"\n        Initialize controller.\n\n        Args:\n            slip_model: SLIP model instance\n            desired_speed: Target forward velocity (m/s)\n            desired_height: Target apex height (m)\n        \"\"\"\n        self.slip = slip_model\n        self.v_des = desired_speed\n        self.z_apex_des = desired_height\n\n        # Gains\n        self.kv = 0.1  # Forward velocity gain\n        self.kp_height = 1000  # Height control (energy injection)\n\n        # State memory\n        self.last_stance_energy = 0\n        self.stride_time = 0.3  # Estimated stride time\n\n    def compute_touchdown_angle(self, state):\n        \"\"\"\n        Compute touchdown angle for speed control.\n\n        Raibert's neutral point + velocity correction.\n\n        Args:\n            state: Current [x, z, xdot, zdot]\n\n        Returns:\n            theta: Touchdown angle (rad from vertical)\n        \"\"\"\n        x, z, xdot, zdot = state\n\n        # Neutral point: leg should land at position where\n        # COM will be directly above foot at mid-stance\n        # theta_neutral = arcsin(v * T_stance / 2 / r0)\n        T_stance_est = 0.15  # Estimated stance duration\n        theta_neutral = np.arcsin(np.clip(xdot * T_stance_est / 2 / self.slip.r0, -1, 1))\n\n        # Velocity correction\n        v_error = xdot - self.v_des\n        theta_correction = self.kv * v_error\n\n        theta = theta_neutral + theta_correction\n\n        # Limit angle\n        theta = np.clip(theta, -0.5, 0.5)\n\n        return theta\n\n    def compute_energy_injection(self, state):\n        \"\"\"\n        Compute energy to inject during stance for height control.\n\n        Args:\n            state: Current state\n\n        Returns:\n            energy: Energy to add (J)\n        \"\"\"\n        x, z, xdot, zdot = state\n\n        # Current total energy\n        KE = 0.5 * self.slip.m * (xdot**2 + zdot**2)\n        PE = self.slip.m * self.slip.g * z\n        E_current = KE + PE\n\n        # Desired energy at apex (all potential)\n        E_desired = self.slip.m * self.slip.g * self.z_apex_des + \\\n                    0.5 * self.slip.m * self.v_des**2\n\n        # Energy to inject\n        delta_E = E_desired - E_current\n\n        return delta_E\n\n    def run_simulation(self, n_steps=10, initial_state=None):\n        \"\"\"\n        Run multiple steps with control.\n\n        Args:\n            n_steps: Number of steps\n            initial_state: Initial [x, z, xdot, zdot]\n\n        Returns:\n            full_trajectory: Complete trajectory data\n        \"\"\"\n        if initial_state is None:\n            initial_state = [0, 1.3, self.v_des, 0]\n\n        trajectory = {\n            'time': [],\n            'x': [],\n            'z': [],\n            'xdot': [],\n            'zdot': [],\n            'phase': [],\n            'touchdown_angle': [],\n            'apex_height': []\n        }\n\n        state = initial_state.copy()\n        t_offset = 0\n\n        for step in range(n_steps):\n            # Compute control\n            theta = self.compute_touchdown_angle(state)\n\n            # Simulate step\n            self.slip.phase = 'flight' if state[1] > 1.05 * self.slip.r0 else 'stance'\n            t, states, events = self.slip.simulate_step(state, theta)\n\n            # Record\n            for i in range(len(t)):\n                trajectory['time'].append(t[i] + t_offset)\n                trajectory['x'].append(states[i, 0])\n                trajectory['z'].append(states[i, 1])\n                trajectory['xdot'].append(states[i, 2])\n                trajectory['zdot'].append(states[i, 3])\n                trajectory['phase'].append(step)\n\n            trajectory['touchdown_angle'].append(theta)\n\n            # Find apex (max z)\n            apex_idx = np.argmax(states[:, 1])\n            trajectory['apex_height'].append(states[apex_idx, 1])\n\n            # Update for next step\n            state = states[-1].tolist()\n            t_offset += t[-1]\n\n            print(f\"Step {step}: apex={states[apex_idx, 1]:.3f}m, \"\n                  f\"v={states[-1, 2]:.2f}m/s, theta={np.rad2deg(theta):.1f}\xb0\")\n\n        return trajectory\n\n# Create controller\ncontroller = RaibertController(slip, desired_speed=3.0, desired_height=1.15)\n\n# Run simulation\ntrajectory = controller.run_simulation(n_steps=8)\n\nprint(f\"\\nSimulation complete\")\nprint(f\"Total distance: {trajectory['x'][-1]:.2f} m\")\nprint(f\"Average speed: {np.mean(trajectory['xdot']):.2f} m/s\")\nprint(f\"Apex heights: {trajectory['apex_height']}\")\n"})}),"\n",(0,i.jsx)("checkpoint",{children:(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Expected"}),": Multiple running steps with speed and height regulation."]})}),"\n",(0,i.jsx)(n.h3,{id:"step-3-implement-flight-phase-control",children:"Step 3: Implement Flight Phase Control"}),"\n",(0,i.jsx)(n.p,{children:"Add control during flight for attitude:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:'class FlightPhaseController:\n    """Controller for flight phase: attitude and leg positioning."""\n\n    def __init__(self, slip_model):\n        self.slip = slip_model\n\n        # Attitude control (if robot has rotational DOF)\n        self.kp_pitch = 50\n        self.kd_pitch = 10\n\n        # Leg retraction for clearance\n        self.retract_ratio = 0.9  # Retract to 90% of leg length\n\n    def compute_leg_angle_trajectory(self, current_angle, target_angle, flight_time, dt=0.01):\n        """\n        Generate smooth leg swing trajectory.\n\n        Args:\n            current_angle: Current leg angle (rad)\n            target_angle: Target touchdown angle (rad)\n            flight_time: Available flight time (s)\n            dt: Time step\n\n        Returns:\n            t: Time array\n            angles: Leg angle trajectory\n        """\n        t = np.arange(0, flight_time, dt)\n        n = len(t)\n\n        # Use smooth 5th order polynomial\n        s = t / flight_time\n        h = 10*s**3 - 15*s**4 + 6*s**5\n\n        angles = current_angle + h * (target_angle - current_angle)\n\n        return t, angles\n\n    def compute_leg_retraction_trajectory(self, flight_time, dt=0.01):\n        """\n        Generate leg length trajectory: retract then extend.\n\n        Returns:\n            t: Time array\n            lengths: Leg length trajectory\n        """\n        t = np.arange(0, flight_time, dt)\n\n        # Retract in first half, extend in second\n        lengths = np.zeros_like(t)\n        for i, ti in enumerate(t):\n            s = ti / flight_time\n```python\n```python\n            if s < 0.5:\n'})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:'                # Retract\n                lengths[i] = self.slip.r0 * (1 - (1-self.retract_ratio) * 2*s)\n            else:\n                # Extend\n                lengths[i] = self.slip.r0 * (self.retract_ratio + (1-self.retract_ratio) * 2*(s-0.5))\n\n        return t, lengths\n\n# Test flight control\nflight_ctrl = FlightPhaseController(slip)\n\n# Leg swing from -0.2 to 0.3 rad over 0.2s flight\nt_leg, angles = flight_ctrl.compute_leg_angle_trajectory(-0.2, 0.3, 0.2)\nt_ret, lengths = flight_ctrl.compute_leg_retraction_trajectory(0.2)\n\nprint(f"Flight phase control trajectories generated")\nprint(f"Leg angle: {angles[0]:.2f} to {angles[-1]:.2f} rad")\nprint(f"Leg length: {lengths[0]:.2f} to {lengths[-1]:.2f} m (min: {min(lengths):.2f})")\n'})}),"\n",(0,i.jsx)("checkpoint",{children:(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Expected"}),": Smooth leg swing and retraction trajectories for flight phase."]})}),"\n",(0,i.jsx)(n.h3,{id:"step-4-energy-analysis",children:"Step 4: Energy Analysis"}),"\n",(0,i.jsx)(n.p,{children:"Analyze energy exchange during running:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"class EnergyAnalyzer:\n    \"\"\"Analyze energy exchange in running.\"\"\"\n\n    def __init__(self, slip_model):\n        self.slip = slip_model\n\n    def compute_energies(self, trajectory):\n        \"\"\"\n        Compute energy components over trajectory.\n\n        Returns:\n            energies: Dict with KE, PE, spring, total\n        \"\"\"\n        n = len(trajectory['time'])\n\n        energies = {\n            'kinetic': np.zeros(n),\n            'potential': np.zeros(n),\n            'total': np.zeros(n)\n        }\n\n        for i in range(n):\n            x = trajectory['x'][i]\n            z = trajectory['z'][i]\n            xdot = trajectory['xdot'][i]\n            zdot = trajectory['zdot'][i]\n\n            # Kinetic energy\n            KE = 0.5 * self.slip.m * (xdot**2 + zdot**2)\n            energies['kinetic'][i] = KE\n\n            # Potential energy\n            PE = self.slip.m * self.slip.g * z\n            energies['potential'][i] = PE\n\n            # Total mechanical energy\n            energies['total'][i] = KE + PE\n\n        return energies\n\n    def compute_cost_of_transport(self, trajectory, energies):\n        \"\"\"\n        Compute Cost of Transport (CoT).\n\n        CoT = Energy used / (weight * distance)\n\n        For passive SLIP, this measures energy dissipation.\n        \"\"\"\n        # Distance traveled\n        distance = trajectory['x'][-1] - trajectory['x'][0]\n\n        # Energy change (ideally zero for conservative SLIP)\n        E_initial = energies['total'][0]\n        E_final = energies['total'][-1]\n        E_lost = E_initial - E_final\n\n        # Weight\n        weight = self.slip.m * self.slip.g\n\n        # CoT\n```python\n```python\n        if distance > 0:\n"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"            cot = abs(E_lost) / (weight * distance)\n        else:\n            cot = float('inf')\n\n        return {\n            'distance': distance,\n            'energy_lost': E_lost,\n            'cot': cot,\n            'cot_dim': cot  # Dimensionless\n        }\n\n# Analyze running trajectory\nanalyzer = EnergyAnalyzer(slip)\nenergies = analyzer.compute_energies(trajectory)\ncot = analyzer.compute_cost_of_transport(trajectory, energies)\n\nprint(f\"\\nEnergy Analysis:\")\nprint(f\"  Initial KE: {energies['kinetic'][0]:.1f} J\")\nprint(f\"  Initial PE: {energies['potential'][0]:.1f} J\")\nprint(f\"  Initial Total: {energies['total'][0]:.1f} J\")\nprint(f\"  Final Total: {energies['total'][-1]:.1f} J\")\nprint(f\"  Energy lost: {cot['energy_lost']:.1f} J\")\nprint(f\"\\nCost of Transport:\")\nprint(f\"  Distance: {cot['distance']:.2f} m\")\nprint(f\"  CoT: {cot['cot']:.4f}\")\n"})}),"\n",(0,i.jsx)("checkpoint",{children:(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Expected"}),": Energy analysis showing kinetic-potential exchange during running."]})}),"\n",(0,i.jsx)(n.h3,{id:"step-5-compare-walking-vs-running",children:"Step 5: Compare Walking vs Running"}),"\n",(0,i.jsx)(n.p,{children:"Analyze tradeoffs between gaits:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"def compare_gaits(distance=20):\n    \"\"\"\n    Compare walking and running gaits.\n\n    Args:\n        distance: Distance to cover (m)\n\n    Returns:\n        comparison: Dictionary of metrics\n    \"\"\"\n    comparison = {}\n\n    # Walking parameters (from Lab 08-02 theory)\n    walking = {\n        'speed': 1.2,  # m/s\n        'step_length': 0.6,  # m\n        'step_frequency': 2.0,  # Hz\n        'cot': 0.3,  # Typical human walking CoT\n        'time': distance / 1.2\n    }\n\n    # Running parameters\n    running = {\n        'speed': 3.0,  # m/s\n        'step_length': 1.2,  # m\n        'step_frequency': 2.5,  # Hz\n        'cot': 0.5,  # Typical running CoT (higher due to vertical oscillation)\n        'time': distance / 3.0\n    }\n\n    # Mechanical work\n    walking['work'] = walking['cot'] * 80 * 9.81 * distance\n    running['work'] = running['cot'] * 80 * 9.81 * distance\n\n    # Power\n    walking['power'] = walking['work'] / walking['time']\n    running['power'] = running['work'] / running['time']\n\n    print(f\"\\nGait Comparison for {distance}m:\")\n    print(f\"{'Metric':<20} {'Walking':<15} {'Running':<15}\")\n    print(\"-\" * 50)\n    print(f\"{'Speed (m/s)':<20} {walking['speed']:<15.1f} {running['speed']:<15.1f}\")\n    print(f\"{'Time (s)':<20} {walking['time']:<15.1f} {running['time']:<15.1f}\")\n    print(f\"{'Step length (m)':<20} {walking['step_length']:<15.2f} {running['step_length']:<15.2f}\")\n    print(f\"{'Step freq (Hz)':<20} {walking['step_frequency']:<15.1f} {running['step_frequency']:<15.1f}\")\n    print(f\"{'CoT':<20} {walking['cot']:<15.2f} {running['cot']:<15.2f}\")\n    print(f\"{'Work (J)':<20} {walking['work']:<15.0f} {running['work']:<15.0f}\")\n    print(f\"{'Power (W)':<20} {walking['power']:<15.0f} {running['power']:<15.0f}\")\n\n    return walking, running\n\nwalking_data, running_data = compare_gaits(distance=100)\n\n# Froude number analysis\ndef compute_froude_number(speed, leg_length=1.0, g=9.81):\n    \"\"\"\n    Compute Froude number: Fr = v^2 / (g * L)\n\n    Fr < 0.5: Walking preferred\n    Fr > 0.5: Running preferred\n    \"\"\"\n    return speed**2 / (g * leg_length)\n\nprint(f\"\\nFroude Number Analysis:\")\nprint(f\"  Walking (1.2 m/s): Fr = {compute_froude_number(1.2):.2f}\")\n    print(f\"  Running (3.0 m/s): Fr = {compute_froude_number(3.0):.2f}\")\nprint(f\"  Transition point: Fr \u2248 0.5 \u2192 v \u2248 {np.sqrt(0.5 * 9.81 * 1.0):.1f} m/s\")\n"})}),"\n",(0,i.jsx)("checkpoint",{children:(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Expected"}),": Walking vs running comparison showing speed/energy tradeoffs."]})}),"\n",(0,i.jsx)(n.h3,{id:"step-6-mujoco-running-simulation",children:"Step 6: MuJoCo Running Simulation"}),"\n",(0,i.jsx)(n.p,{children:"Implement running in full physics simulation:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"def run_mujoco_simulation():\n    \"\"\"\n    Execute running in MuJoCo simulation.\n\n    This requires a proper running robot model.\n    \"\"\"\n    # Load model\n    try:\n        model = mujoco.MjModel.from_xml_path(\n            \"textbook/assets/robot-models/mujoco/slip-runner.xml\"\n        )\n        data = mujoco.MjData(model)\n    except:\n        print(\"Note: slip-runner.xml not found. Using SLIP model analysis only.\")\n        return None\n\n    # Initialize\n    mujoco.mj_resetData(model, data)\n\n    # Set initial velocity\n    data.qvel[0] = 3.0  # Forward velocity\n\n    # Simulation parameters\n    dt = model.opt.timestep\n    duration = 5.0\n    steps = int(duration / dt)\n\n    history = {\n        'time': [],\n        'x': [],\n        'z': [],\n        'xdot': [],\n        'zdot': []\n    }\n\n    for i in range(steps):\n        # Step simulation\n        mujoco.mj_step(model, data)\n\n        # Record\n        history['time'].append(i * dt)\n        history['x'].append(data.qpos[0])\n        history['z'].append(data.qpos[2])\n        history['xdot'].append(data.qvel[0])\n        history['zdot'].append(data.qvel[2])\n\n    return history\n\nmujoco_history = run_mujoco_simulation()\nif mujoco_history:\n    print(f\"MuJoCo simulation complete: {len(mujoco_history['time'])} steps\")\n"})}),"\n",(0,i.jsx)("checkpoint",{children:(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Expected"}),": Either MuJoCo simulation runs or graceful fallback to SLIP model."]})}),"\n",(0,i.jsx)(n.h2,{id:"expected-outcomes",children:"Expected Outcomes"}),"\n",(0,i.jsx)(n.p,{children:"After completing this lab, you should have:"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Code artifacts"}),":"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"slip_model.py"}),": SLIP dynamics implementation"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"raibert_controller.py"}),": Running controller"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"flight_controller.py"}),": Flight phase control"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"energy_analysis.py"}),": Efficiency metrics"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"gait_comparison.py"}),": Walking vs running analysis"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Understanding"}),":"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"SLIP model as running approximation"}),"\n",(0,i.jsx)(n.li,{children:"Raibert control decomposition"}),"\n",(0,i.jsx)(n.li,{children:"Energy storage and return in running"}),"\n",(0,i.jsx)(n.li,{children:"Walk-run transition principles"}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Experimental results"}),":"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Running trajectory over multiple steps"}),"\n",(0,i.jsx)(n.li,{children:"Energy exchange during running"}),"\n",(0,i.jsx)(n.li,{children:"Gait comparison metrics"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"rubric",children:"Rubric"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Criterion"}),(0,i.jsx)(n.th,{children:"Points"}),(0,i.jsx)(n.th,{children:"Description"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"SLIP Implementation"}),(0,i.jsx)(n.td,{children:"20"}),(0,i.jsx)(n.td,{children:"Correct stance/flight dynamics"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Raibert Controller"}),(0,i.jsx)(n.td,{children:"25"}),(0,i.jsx)(n.td,{children:"Speed and height regulation"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Flight Control"}),(0,i.jsx)(n.td,{children:"15"}),(0,i.jsx)(n.td,{children:"Leg swing and retraction"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Energy Analysis"}),(0,i.jsx)(n.td,{children:"20"}),(0,i.jsx)(n.td,{children:"CoT and efficiency metrics"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Gait Comparison"}),(0,i.jsx)(n.td,{children:"20"}),(0,i.jsx)(n.td,{children:"Walk vs run tradeoff analysis"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"Total"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"100"})}),(0,i.jsx)(n.td,{})]})]})]}),"\n",(0,i.jsx)(n.h2,{id:"common-errors",children:"Common Errors"}),"\n",(0,i.jsxs)("troubleshooting",{children:[(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Error"}),": SLIP simulation crashes or goes unstable\n",(0,i.jsx)(n.strong,{children:"Solution"}),": Check event detection, use smaller time steps during stance."]}),(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Error"}),": Speed doesn't converge to desired\n",(0,i.jsx)(n.strong,{children:"Solution"}),": Tune touchdown angle gain, check Froude number regime."]}),(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Error"}),": Robot falls after few steps\n",(0,i.jsx)(n.strong,{children:"Solution"}),": Check energy balance, adjust stiffness for height."]})]}),"\n",(0,i.jsx)(n.h2,{id:"extensions",children:"Extensions"}),"\n",(0,i.jsx)(n.p,{children:"For advanced students:"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"3D Running"}),": Extend to lateral balance and turning"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Rough Terrain"}),": Add terrain height perturbations"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Learned Running"}),": Train RL policy for robust running"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Quadruped"}),": Extend to 4-leg running gaits (trot, gallop)"]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"related-content",children:"Related Content"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Theory"}),": Module 08 theory.md, Section 8.3 (Dynamic Locomotion)"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Previous Lab"}),": Lab 08-02 (Walking Gait)"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Research"}),": Boston Dynamics running, Agility Robotics Digit"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Biology"}),": Biomechanics of running, SLIP in nature"]}),"\n"]})]})}function m(e={}){const{wrapper:n}={...(0,l.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}},8453(e,n,s){s.d(n,{R:()=>a,x:()=>r});var t=s(6540);const i={},l=t.createContext(i);function a(e){const n=t.useContext(l);return t.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function r(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:a(e.components),t.createElement(l.Provider,{value:n},e.children)}}}]);