"use strict";(globalThis.webpackChunkmy_book=globalThis.webpackChunkmy_book||[]).push([[5373],{2601(s,e,n){n.r(e),n.d(e,{assets:()=>c,contentTitle:()=>r,default:()=>o,frontMatter:()=>l,metadata:()=>a,toc:()=>m});const a=JSON.parse('{"id":"textbook/modules/motion-planning/labs/lab-06-03","title":"Trajectory Optimization","description":"Objectives","source":"@site/docs/textbook/modules/06-motion-planning/labs/lab-06-03.md","sourceDirName":"textbook/modules/06-motion-planning/labs","slug":"/textbook/modules/motion-planning/labs/lab-06-03","permalink":"/Hackathon-3/docs/textbook/modules/motion-planning/labs/lab-06-03","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/textbook/modules/06-motion-planning/labs/lab-06-03.md","tags":[],"version":"current","frontMatter":{"id":"lab-06-03","module_id":"06","title":"Trajectory Optimization","difficulty":"challenge","tier":"simulation","duration_minutes":120},"sidebar":"tutorialSidebar","previous":{"title":"A* Path Planning with Heuristics","permalink":"/Hackathon-3/docs/textbook/modules/motion-planning/labs/lab-06-02"},"next":{"title":"Motion Planning","permalink":"/Hackathon-3/docs/textbook/modules/motion-planning/motion-planning"}}');var i=n(4848),t=n(8453);const l={id:"lab-06-03",module_id:"06",title:"Trajectory Optimization",difficulty:"challenge",tier:"simulation",duration_minutes:120},r="Lab 06-03: Trajectory Optimization",c={},m=[{value:"Objectives",id:"objectives",level:2},{value:"Prerequisites",id:"prerequisites",level:2},{value:"Materials",id:"materials",level:2},{value:"Background",id:"background",level:2},{value:"Trajectory Optimization Problem",id:"trajectory-optimization-problem",level:3},{value:"Direct Collocation",id:"direct-collocation",level:3},{value:"Instructions",id:"instructions",level:2},{value:"Step 1: Define the Problem Structure",id:"step-1-define-the-problem-structure",level:3},{value:"Step 2: Define Cost Function",id:"step-2-define-cost-function",level:3},{value:"Step 3: Implement Dynamics Constraints",id:"step-3-implement-dynamics-constraints",level:3},{value:"Step 4: Boundary and Path Constraints",id:"step-4-boundary-and-path-constraints",level:3},{value:"Step 5: Solve the Optimization",id:"step-5-solve-the-optimization",level:3},{value:"Step 6: Visualize Results",id:"step-6-visualize-results",level:3},{value:"Expected Outcomes",id:"expected-outcomes",level:2},{value:"Rubric",id:"rubric",level:2},{value:"Common Errors",id:"common-errors",level:2},{value:"Extensions",id:"extensions",level:2},{value:"Related Content",id:"related-content",level:2}];function d(s){const e={annotation:"annotation",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",header:"header",input:"input",li:"li",math:"math",mi:"mi",mn:"mn",mo:"mo",mover:"mover",mrow:"mrow",msub:"msub",msubsup:"msubsup",ol:"ol",p:"p",pre:"pre",semantics:"semantics",span:"span",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,t.R)(),...s.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(e.header,{children:(0,i.jsx)(e.h1,{id:"lab-06-03-trajectory-optimization",children:"Lab 06-03: Trajectory Optimization"})}),"\n",(0,i.jsx)(e.h2,{id:"objectives",children:"Objectives"}),"\n",(0,i.jsx)(e.p,{children:"By the end of this lab, you will be able to:"}),"\n",(0,i.jsxs)(e.ul,{className:"contains-task-list",children:["\n",(0,i.jsxs)(e.li,{className:"task-list-item",children:[(0,i.jsx)(e.input,{type:"checkbox",disabled:!0})," ","Formulate trajectory optimization as a constrained optimization problem"]}),"\n",(0,i.jsxs)(e.li,{className:"task-list-item",children:[(0,i.jsx)(e.input,{type:"checkbox",disabled:!0})," ","Implement direct collocation for trajectory planning"]}),"\n",(0,i.jsxs)(e.li,{className:"task-list-item",children:[(0,i.jsx)(e.input,{type:"checkbox",disabled:!0})," ","Handle path constraints and dynamics constraints"]}),"\n",(0,i.jsxs)(e.li,{className:"task-list-item",children:[(0,i.jsx)(e.input,{type:"checkbox",disabled:!0})," ","Optimize for multiple objectives (time, energy, smoothness)"]}),"\n"]}),"\n",(0,i.jsx)(e.h2,{id:"prerequisites",children:"Prerequisites"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"Completed Labs 06-01 and 06-02 (path planning basics)"}),"\n",(0,i.jsx)(e.li,{children:"Understanding of numerical optimization"}),"\n",(0,i.jsx)(e.li,{children:"Familiarity with robot dynamics (Module 05)"}),"\n"]}),"\n",(0,i.jsx)(e.h2,{id:"materials",children:"Materials"}),"\n",(0,i.jsxs)(e.table,{children:[(0,i.jsx)(e.thead,{children:(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.th,{children:"Type"}),(0,i.jsx)(e.th,{children:"Name"}),(0,i.jsx)(e.th,{children:"Tier"}),(0,i.jsx)(e.th,{children:"Notes"})]})}),(0,i.jsxs)(e.tbody,{children:[(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"software"}),(0,i.jsx)(e.td,{children:"Python 3.10+"}),(0,i.jsx)(e.td,{children:"required"}),(0,i.jsx)(e.td,{children:"Programming environment"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"software"}),(0,i.jsx)(e.td,{children:"NumPy, SciPy"}),(0,i.jsx)(e.td,{children:"required"}),(0,i.jsx)(e.td,{children:"Optimization and linear algebra"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"software"}),(0,i.jsx)(e.td,{children:"Matplotlib"}),(0,i.jsx)(e.td,{children:"required"}),(0,i.jsx)(e.td,{children:"Visualization"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"simulation"}),(0,i.jsx)(e.td,{children:"MuJoCo 3.0+"}),(0,i.jsx)(e.td,{children:"optional"}),(0,i.jsx)(e.td,{children:"For dynamics verification"})]})]})]}),"\n",(0,i.jsx)(e.h2,{id:"background",children:"Background"}),"\n",(0,i.jsx)(e.h3,{id:"trajectory-optimization-problem",children:"Trajectory Optimization Problem"}),"\n",(0,i.jsx)(e.p,{children:"Unlike path planning which finds a sequence of positions, trajectory optimization finds time-parameterized motion:"}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.strong,{children:"Minimize"}),": ",(0,i.jsxs)(e.span,{className:"katex",children:[(0,i.jsx)(e.span,{className:"katex-mathml",children:(0,i.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,i.jsxs)(e.semantics,{children:[(0,i.jsxs)(e.mrow,{children:[(0,i.jsx)(e.mi,{children:"J"}),(0,i.jsx)(e.mo,{children:"="}),(0,i.jsxs)(e.msubsup,{children:[(0,i.jsx)(e.mo,{children:"\u222b"}),(0,i.jsx)(e.mn,{children:"0"}),(0,i.jsx)(e.mi,{children:"T"})]}),(0,i.jsx)(e.mi,{children:"L"}),(0,i.jsx)(e.mo,{stretchy:"false",children:"("}),(0,i.jsx)(e.mi,{children:"q"}),(0,i.jsx)(e.mo,{stretchy:"false",children:"("}),(0,i.jsx)(e.mi,{children:"t"}),(0,i.jsx)(e.mo,{stretchy:"false",children:")"}),(0,i.jsx)(e.mo,{separator:"true",children:","}),(0,i.jsxs)(e.mover,{accent:"true",children:[(0,i.jsx)(e.mi,{children:"q"}),(0,i.jsx)(e.mo,{children:"\u02d9"})]}),(0,i.jsx)(e.mo,{stretchy:"false",children:"("}),(0,i.jsx)(e.mi,{children:"t"}),(0,i.jsx)(e.mo,{stretchy:"false",children:")"}),(0,i.jsx)(e.mo,{separator:"true",children:","}),(0,i.jsxs)(e.mover,{accent:"true",children:[(0,i.jsx)(e.mi,{children:"q"}),(0,i.jsx)(e.mo,{children:"\xa8"})]}),(0,i.jsx)(e.mo,{stretchy:"false",children:"("}),(0,i.jsx)(e.mi,{children:"t"}),(0,i.jsx)(e.mo,{stretchy:"false",children:")"}),(0,i.jsx)(e.mo,{separator:"true",children:","}),(0,i.jsx)(e.mi,{children:"u"}),(0,i.jsx)(e.mo,{stretchy:"false",children:"("}),(0,i.jsx)(e.mi,{children:"t"}),(0,i.jsx)(e.mo,{stretchy:"false",children:")"}),(0,i.jsx)(e.mo,{stretchy:"false",children:")"}),(0,i.jsx)(e.mi,{children:"d"}),(0,i.jsx)(e.mi,{children:"t"})]}),(0,i.jsx)(e.annotation,{encoding:"application/x-tex",children:"J = \\int_0^T L(q(t), \\dot{q}(t), \\ddot{q}(t), u(t)) dt"})]})})}),(0,i.jsxs)(e.span,{className:"katex-html","aria-hidden":"true",children:[(0,i.jsxs)(e.span,{className:"base",children:[(0,i.jsx)(e.span,{className:"strut",style:{height:"0.6833em"}}),(0,i.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.09618em"},children:"J"}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,i.jsx)(e.span,{className:"mrel",children:"="}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}})]}),(0,i.jsxs)(e.span,{className:"base",children:[(0,i.jsx)(e.span,{className:"strut",style:{height:"1.3921em",verticalAlign:"-0.3558em"}}),(0,i.jsxs)(e.span,{className:"mop",children:[(0,i.jsx)(e.span,{className:"mop op-symbol small-op",style:{marginRight:"0.19445em",position:"relative",top:"-0.0006em"},children:"\u222b"}),(0,i.jsx)(e.span,{className:"msupsub",children:(0,i.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,i.jsxs)(e.span,{className:"vlist-r",children:[(0,i.jsxs)(e.span,{className:"vlist",style:{height:"1.0362em"},children:[(0,i.jsxs)(e.span,{style:{top:"-2.3442em",marginLeft:"-0.1945em",marginRight:"0.05em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,i.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,i.jsx)(e.span,{className:"mord mtight",children:"0"})})]}),(0,i.jsxs)(e.span,{style:{top:"-3.2579em",marginRight:"0.05em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,i.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,i.jsx)(e.span,{className:"mord mathnormal mtight",style:{marginRight:"0.13889em"},children:"T"})})]})]}),(0,i.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,i.jsx)(e.span,{className:"vlist-r",children:(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.3558em"},children:(0,i.jsx)(e.span,{})})})]})})]}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.1667em"}}),(0,i.jsx)(e.span,{className:"mord mathnormal",children:"L"}),(0,i.jsx)(e.span,{className:"mopen",children:"("}),(0,i.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.03588em"},children:"q"}),(0,i.jsx)(e.span,{className:"mopen",children:"("}),(0,i.jsx)(e.span,{className:"mord mathnormal",children:"t"}),(0,i.jsx)(e.span,{className:"mclose",children:")"}),(0,i.jsx)(e.span,{className:"mpunct",children:","}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.1667em"}}),(0,i.jsx)(e.span,{className:"mord accent",children:(0,i.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,i.jsxs)(e.span,{className:"vlist-r",children:[(0,i.jsxs)(e.span,{className:"vlist",style:{height:"0.6679em"},children:[(0,i.jsxs)(e.span,{style:{top:"-3em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"3em"}}),(0,i.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.03588em"},children:"q"})]}),(0,i.jsxs)(e.span,{style:{top:"-3em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"3em"}}),(0,i.jsx)(e.span,{className:"accent-body",style:{left:"-0.0556em"},children:(0,i.jsx)(e.span,{className:"mord",children:"\u02d9"})})]})]}),(0,i.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,i.jsx)(e.span,{className:"vlist-r",children:(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.1944em"},children:(0,i.jsx)(e.span,{})})})]})}),(0,i.jsx)(e.span,{className:"mopen",children:"("}),(0,i.jsx)(e.span,{className:"mord mathnormal",children:"t"}),(0,i.jsx)(e.span,{className:"mclose",children:")"}),(0,i.jsx)(e.span,{className:"mpunct",children:","}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.1667em"}}),(0,i.jsx)(e.span,{className:"mord accent",children:(0,i.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,i.jsxs)(e.span,{className:"vlist-r",children:[(0,i.jsxs)(e.span,{className:"vlist",style:{height:"0.6679em"},children:[(0,i.jsxs)(e.span,{style:{top:"-3em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"3em"}}),(0,i.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.03588em"},children:"q"})]}),(0,i.jsxs)(e.span,{style:{top:"-3em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"3em"}}),(0,i.jsx)(e.span,{className:"accent-body",style:{left:"-0.1667em"},children:(0,i.jsx)(e.span,{className:"mord",children:"\xa8"})})]})]}),(0,i.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,i.jsx)(e.span,{className:"vlist-r",children:(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.1944em"},children:(0,i.jsx)(e.span,{})})})]})}),(0,i.jsx)(e.span,{className:"mopen",children:"("}),(0,i.jsx)(e.span,{className:"mord mathnormal",children:"t"}),(0,i.jsx)(e.span,{className:"mclose",children:")"}),(0,i.jsx)(e.span,{className:"mpunct",children:","}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.1667em"}}),(0,i.jsx)(e.span,{className:"mord mathnormal",children:"u"}),(0,i.jsx)(e.span,{className:"mopen",children:"("}),(0,i.jsx)(e.span,{className:"mord mathnormal",children:"t"}),(0,i.jsx)(e.span,{className:"mclose",children:"))"}),(0,i.jsx)(e.span,{className:"mord mathnormal",children:"d"}),(0,i.jsx)(e.span,{className:"mord mathnormal",children:"t"})]})]})]})]}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.strong,{children:"Subject to"}),":"]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["Dynamics: ",(0,i.jsxs)(e.span,{className:"katex",children:[(0,i.jsx)(e.span,{className:"katex-mathml",children:(0,i.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,i.jsxs)(e.semantics,{children:[(0,i.jsxs)(e.mrow,{children:[(0,i.jsx)(e.mi,{children:"M"}),(0,i.jsx)(e.mo,{stretchy:"false",children:"("}),(0,i.jsx)(e.mi,{children:"q"}),(0,i.jsx)(e.mo,{stretchy:"false",children:")"}),(0,i.jsxs)(e.mover,{accent:"true",children:[(0,i.jsx)(e.mi,{children:"q"}),(0,i.jsx)(e.mo,{children:"\xa8"})]}),(0,i.jsx)(e.mo,{children:"+"}),(0,i.jsx)(e.mi,{children:"C"}),(0,i.jsx)(e.mo,{stretchy:"false",children:"("}),(0,i.jsx)(e.mi,{children:"q"}),(0,i.jsx)(e.mo,{separator:"true",children:","}),(0,i.jsxs)(e.mover,{accent:"true",children:[(0,i.jsx)(e.mi,{children:"q"}),(0,i.jsx)(e.mo,{children:"\u02d9"})]}),(0,i.jsx)(e.mo,{stretchy:"false",children:")"}),(0,i.jsxs)(e.mover,{accent:"true",children:[(0,i.jsx)(e.mi,{children:"q"}),(0,i.jsx)(e.mo,{children:"\u02d9"})]}),(0,i.jsx)(e.mo,{children:"+"}),(0,i.jsx)(e.mi,{children:"g"}),(0,i.jsx)(e.mo,{stretchy:"false",children:"("}),(0,i.jsx)(e.mi,{children:"q"}),(0,i.jsx)(e.mo,{stretchy:"false",children:")"}),(0,i.jsx)(e.mo,{children:"="}),(0,i.jsx)(e.mi,{children:"u"})]}),(0,i.jsx)(e.annotation,{encoding:"application/x-tex",children:"M(q)\\ddot{q} + C(q,\\dot{q})\\dot{q} + g(q) = u"})]})})}),(0,i.jsxs)(e.span,{className:"katex-html","aria-hidden":"true",children:[(0,i.jsxs)(e.span,{className:"base",children:[(0,i.jsx)(e.span,{className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,i.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.10903em"},children:"M"}),(0,i.jsx)(e.span,{className:"mopen",children:"("}),(0,i.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.03588em"},children:"q"}),(0,i.jsx)(e.span,{className:"mclose",children:")"}),(0,i.jsx)(e.span,{className:"mord accent",children:(0,i.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,i.jsxs)(e.span,{className:"vlist-r",children:[(0,i.jsxs)(e.span,{className:"vlist",style:{height:"0.6679em"},children:[(0,i.jsxs)(e.span,{style:{top:"-3em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"3em"}}),(0,i.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.03588em"},children:"q"})]}),(0,i.jsxs)(e.span,{style:{top:"-3em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"3em"}}),(0,i.jsx)(e.span,{className:"accent-body",style:{left:"-0.1667em"},children:(0,i.jsx)(e.span,{className:"mord",children:"\xa8"})})]})]}),(0,i.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,i.jsx)(e.span,{className:"vlist-r",children:(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.1944em"},children:(0,i.jsx)(e.span,{})})})]})}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,i.jsx)(e.span,{className:"mbin",children:"+"}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}})]}),(0,i.jsxs)(e.span,{className:"base",children:[(0,i.jsx)(e.span,{className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,i.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.07153em"},children:"C"}),(0,i.jsx)(e.span,{className:"mopen",children:"("}),(0,i.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.03588em"},children:"q"}),(0,i.jsx)(e.span,{className:"mpunct",children:","}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.1667em"}}),(0,i.jsx)(e.span,{className:"mord accent",children:(0,i.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,i.jsxs)(e.span,{className:"vlist-r",children:[(0,i.jsxs)(e.span,{className:"vlist",style:{height:"0.6679em"},children:[(0,i.jsxs)(e.span,{style:{top:"-3em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"3em"}}),(0,i.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.03588em"},children:"q"})]}),(0,i.jsxs)(e.span,{style:{top:"-3em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"3em"}}),(0,i.jsx)(e.span,{className:"accent-body",style:{left:"-0.0556em"},children:(0,i.jsx)(e.span,{className:"mord",children:"\u02d9"})})]})]}),(0,i.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,i.jsx)(e.span,{className:"vlist-r",children:(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.1944em"},children:(0,i.jsx)(e.span,{})})})]})}),(0,i.jsx)(e.span,{className:"mclose",children:")"}),(0,i.jsx)(e.span,{className:"mord accent",children:(0,i.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,i.jsxs)(e.span,{className:"vlist-r",children:[(0,i.jsxs)(e.span,{className:"vlist",style:{height:"0.6679em"},children:[(0,i.jsxs)(e.span,{style:{top:"-3em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"3em"}}),(0,i.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.03588em"},children:"q"})]}),(0,i.jsxs)(e.span,{style:{top:"-3em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"3em"}}),(0,i.jsx)(e.span,{className:"accent-body",style:{left:"-0.0556em"},children:(0,i.jsx)(e.span,{className:"mord",children:"\u02d9"})})]})]}),(0,i.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,i.jsx)(e.span,{className:"vlist-r",children:(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.1944em"},children:(0,i.jsx)(e.span,{})})})]})}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,i.jsx)(e.span,{className:"mbin",children:"+"}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}})]}),(0,i.jsxs)(e.span,{className:"base",children:[(0,i.jsx)(e.span,{className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,i.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.03588em"},children:"g"}),(0,i.jsx)(e.span,{className:"mopen",children:"("}),(0,i.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.03588em"},children:"q"}),(0,i.jsx)(e.span,{className:"mclose",children:")"}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,i.jsx)(e.span,{className:"mrel",children:"="}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}})]}),(0,i.jsxs)(e.span,{className:"base",children:[(0,i.jsx)(e.span,{className:"strut",style:{height:"0.4306em"}}),(0,i.jsx)(e.span,{className:"mord mathnormal",children:"u"})]})]})]})]}),"\n",(0,i.jsxs)(e.li,{children:["Initial/final conditions: ",(0,i.jsxs)(e.span,{className:"katex",children:[(0,i.jsx)(e.span,{className:"katex-mathml",children:(0,i.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,i.jsxs)(e.semantics,{children:[(0,i.jsxs)(e.mrow,{children:[(0,i.jsx)(e.mi,{children:"q"}),(0,i.jsx)(e.mo,{stretchy:"false",children:"("}),(0,i.jsx)(e.mn,{children:"0"}),(0,i.jsx)(e.mo,{stretchy:"false",children:")"}),(0,i.jsx)(e.mo,{children:"="}),(0,i.jsxs)(e.msub,{children:[(0,i.jsx)(e.mi,{children:"q"}),(0,i.jsx)(e.mn,{children:"0"})]})]}),(0,i.jsx)(e.annotation,{encoding:"application/x-tex",children:"q(0) = q_0"})]})})}),(0,i.jsxs)(e.span,{className:"katex-html","aria-hidden":"true",children:[(0,i.jsxs)(e.span,{className:"base",children:[(0,i.jsx)(e.span,{className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,i.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.03588em"},children:"q"}),(0,i.jsx)(e.span,{className:"mopen",children:"("}),(0,i.jsx)(e.span,{className:"mord",children:"0"}),(0,i.jsx)(e.span,{className:"mclose",children:")"}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,i.jsx)(e.span,{className:"mrel",children:"="}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}})]}),(0,i.jsxs)(e.span,{className:"base",children:[(0,i.jsx)(e.span,{className:"strut",style:{height:"0.625em",verticalAlign:"-0.1944em"}}),(0,i.jsxs)(e.span,{className:"mord",children:[(0,i.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.03588em"},children:"q"}),(0,i.jsx)(e.span,{className:"msupsub",children:(0,i.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,i.jsxs)(e.span,{className:"vlist-r",children:[(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.3011em"},children:(0,i.jsxs)(e.span,{style:{top:"-2.55em",marginLeft:"-0.0359em",marginRight:"0.05em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,i.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,i.jsx)(e.span,{className:"mord mtight",children:"0"})})]})}),(0,i.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,i.jsx)(e.span,{className:"vlist-r",children:(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.15em"},children:(0,i.jsx)(e.span,{})})})]})})]})]})]})]}),", ",(0,i.jsxs)(e.span,{className:"katex",children:[(0,i.jsx)(e.span,{className:"katex-mathml",children:(0,i.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,i.jsxs)(e.semantics,{children:[(0,i.jsxs)(e.mrow,{children:[(0,i.jsx)(e.mi,{children:"q"}),(0,i.jsx)(e.mo,{stretchy:"false",children:"("}),(0,i.jsx)(e.mi,{children:"T"}),(0,i.jsx)(e.mo,{stretchy:"false",children:")"}),(0,i.jsx)(e.mo,{children:"="}),(0,i.jsxs)(e.msub,{children:[(0,i.jsx)(e.mi,{children:"q"}),(0,i.jsx)(e.mi,{children:"f"})]})]}),(0,i.jsx)(e.annotation,{encoding:"application/x-tex",children:"q(T) = q_f"})]})})}),(0,i.jsxs)(e.span,{className:"katex-html","aria-hidden":"true",children:[(0,i.jsxs)(e.span,{className:"base",children:[(0,i.jsx)(e.span,{className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,i.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.03588em"},children:"q"}),(0,i.jsx)(e.span,{className:"mopen",children:"("}),(0,i.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.13889em"},children:"T"}),(0,i.jsx)(e.span,{className:"mclose",children:")"}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,i.jsx)(e.span,{className:"mrel",children:"="}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}})]}),(0,i.jsxs)(e.span,{className:"base",children:[(0,i.jsx)(e.span,{className:"strut",style:{height:"0.7167em",verticalAlign:"-0.2861em"}}),(0,i.jsxs)(e.span,{className:"mord",children:[(0,i.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.03588em"},children:"q"}),(0,i.jsx)(e.span,{className:"msupsub",children:(0,i.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,i.jsxs)(e.span,{className:"vlist-r",children:[(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.3361em"},children:(0,i.jsxs)(e.span,{style:{top:"-2.55em",marginLeft:"-0.0359em",marginRight:"0.05em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,i.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,i.jsx)(e.span,{className:"mord mathnormal mtight",style:{marginRight:"0.10764em"},children:"f"})})]})}),(0,i.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,i.jsx)(e.span,{className:"vlist-r",children:(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.2861em"},children:(0,i.jsx)(e.span,{})})})]})})]})]})]})]})]}),"\n",(0,i.jsxs)(e.li,{children:["Path constraints: ",(0,i.jsxs)(e.span,{className:"katex",children:[(0,i.jsx)(e.span,{className:"katex-mathml",children:(0,i.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,i.jsxs)(e.semantics,{children:[(0,i.jsxs)(e.mrow,{children:[(0,i.jsx)(e.mi,{children:"c"}),(0,i.jsx)(e.mo,{stretchy:"false",children:"("}),(0,i.jsx)(e.mi,{children:"q"}),(0,i.jsx)(e.mo,{stretchy:"false",children:"("}),(0,i.jsx)(e.mi,{children:"t"}),(0,i.jsx)(e.mo,{stretchy:"false",children:")"}),(0,i.jsx)(e.mo,{stretchy:"false",children:")"}),(0,i.jsx)(e.mo,{children:"\u2264"}),(0,i.jsx)(e.mn,{children:"0"})]}),(0,i.jsx)(e.annotation,{encoding:"application/x-tex",children:"c(q(t)) \\leq 0"})]})})}),(0,i.jsxs)(e.span,{className:"katex-html","aria-hidden":"true",children:[(0,i.jsxs)(e.span,{className:"base",children:[(0,i.jsx)(e.span,{className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,i.jsx)(e.span,{className:"mord mathnormal",children:"c"}),(0,i.jsx)(e.span,{className:"mopen",children:"("}),(0,i.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.03588em"},children:"q"}),(0,i.jsx)(e.span,{className:"mopen",children:"("}),(0,i.jsx)(e.span,{className:"mord mathnormal",children:"t"}),(0,i.jsx)(e.span,{className:"mclose",children:"))"}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,i.jsx)(e.span,{className:"mrel",children:"\u2264"}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}})]}),(0,i.jsxs)(e.span,{className:"base",children:[(0,i.jsx)(e.span,{className:"strut",style:{height:"0.6444em"}}),(0,i.jsx)(e.span,{className:"mord",children:"0"})]})]})]})]}),"\n",(0,i.jsxs)(e.li,{children:["Control limits: ",(0,i.jsxs)(e.span,{className:"katex",children:[(0,i.jsx)(e.span,{className:"katex-mathml",children:(0,i.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,i.jsxs)(e.semantics,{children:[(0,i.jsxs)(e.mrow,{children:[(0,i.jsxs)(e.msub,{children:[(0,i.jsx)(e.mi,{children:"u"}),(0,i.jsxs)(e.mrow,{children:[(0,i.jsx)(e.mi,{children:"m"}),(0,i.jsx)(e.mi,{children:"i"}),(0,i.jsx)(e.mi,{children:"n"})]})]}),(0,i.jsx)(e.mo,{children:"\u2264"}),(0,i.jsx)(e.mi,{children:"u"}),(0,i.jsx)(e.mo,{children:"\u2264"}),(0,i.jsxs)(e.msub,{children:[(0,i.jsx)(e.mi,{children:"u"}),(0,i.jsxs)(e.mrow,{children:[(0,i.jsx)(e.mi,{children:"m"}),(0,i.jsx)(e.mi,{children:"a"}),(0,i.jsx)(e.mi,{children:"x"})]})]})]}),(0,i.jsx)(e.annotation,{encoding:"application/x-tex",children:"u_{min} \\leq u \\leq u_{max}"})]})})}),(0,i.jsxs)(e.span,{className:"katex-html","aria-hidden":"true",children:[(0,i.jsxs)(e.span,{className:"base",children:[(0,i.jsx)(e.span,{className:"strut",style:{height:"0.786em",verticalAlign:"-0.15em"}}),(0,i.jsxs)(e.span,{className:"mord",children:[(0,i.jsx)(e.span,{className:"mord mathnormal",children:"u"}),(0,i.jsx)(e.span,{className:"msupsub",children:(0,i.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,i.jsxs)(e.span,{className:"vlist-r",children:[(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.3117em"},children:(0,i.jsxs)(e.span,{style:{top:"-2.55em",marginLeft:"0em",marginRight:"0.05em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,i.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,i.jsx)(e.span,{className:"mord mtight",children:(0,i.jsx)(e.span,{className:"mord mathnormal mtight",children:"min"})})})]})}),(0,i.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,i.jsx)(e.span,{className:"vlist-r",children:(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.15em"},children:(0,i.jsx)(e.span,{})})})]})})]}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,i.jsx)(e.span,{className:"mrel",children:"\u2264"}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}})]}),(0,i.jsxs)(e.span,{className:"base",children:[(0,i.jsx)(e.span,{className:"strut",style:{height:"0.7719em",verticalAlign:"-0.136em"}}),(0,i.jsx)(e.span,{className:"mord mathnormal",children:"u"}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,i.jsx)(e.span,{className:"mrel",children:"\u2264"}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}})]}),(0,i.jsxs)(e.span,{className:"base",children:[(0,i.jsx)(e.span,{className:"strut",style:{height:"0.5806em",verticalAlign:"-0.15em"}}),(0,i.jsxs)(e.span,{className:"mord",children:[(0,i.jsx)(e.span,{className:"mord mathnormal",children:"u"}),(0,i.jsx)(e.span,{className:"msupsub",children:(0,i.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,i.jsxs)(e.span,{className:"vlist-r",children:[(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.1514em"},children:(0,i.jsxs)(e.span,{style:{top:"-2.55em",marginLeft:"0em",marginRight:"0.05em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,i.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,i.jsxs)(e.span,{className:"mord mtight",children:[(0,i.jsx)(e.span,{className:"mord mathnormal mtight",children:"ma"}),(0,i.jsx)(e.span,{className:"mord mathnormal mtight",children:"x"})]})})]})}),(0,i.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,i.jsx)(e.span,{className:"vlist-r",children:(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.15em"},children:(0,i.jsx)(e.span,{})})})]})})]})]})]})]})]}),"\n"]}),"\n",(0,i.jsx)(e.h3,{id:"direct-collocation",children:"Direct Collocation"}),"\n",(0,i.jsx)(e.p,{children:"Discretize trajectory into N waypoints and optimize all at once:"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["Decision variables: ",(0,i.jsxs)(e.span,{className:"katex",children:[(0,i.jsx)(e.span,{className:"katex-mathml",children:(0,i.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,i.jsxs)(e.semantics,{children:[(0,i.jsxs)(e.mrow,{children:[(0,i.jsx)(e.mo,{stretchy:"false",children:"["}),(0,i.jsxs)(e.msub,{children:[(0,i.jsx)(e.mi,{children:"q"}),(0,i.jsx)(e.mn,{children:"1"})]}),(0,i.jsx)(e.mo,{separator:"true",children:","}),(0,i.jsxs)(e.msub,{children:[(0,i.jsx)(e.mi,{children:"q"}),(0,i.jsx)(e.mn,{children:"2"})]}),(0,i.jsx)(e.mo,{separator:"true",children:","}),(0,i.jsx)(e.mi,{mathvariant:"normal",children:"."}),(0,i.jsx)(e.mi,{mathvariant:"normal",children:"."}),(0,i.jsx)(e.mi,{mathvariant:"normal",children:"."}),(0,i.jsx)(e.mo,{separator:"true",children:","}),(0,i.jsxs)(e.msub,{children:[(0,i.jsx)(e.mi,{children:"q"}),(0,i.jsx)(e.mi,{children:"N"})]}),(0,i.jsx)(e.mo,{separator:"true",children:","}),(0,i.jsxs)(e.msub,{children:[(0,i.jsxs)(e.mover,{accent:"true",children:[(0,i.jsx)(e.mi,{children:"q"}),(0,i.jsx)(e.mo,{children:"\u02d9"})]}),(0,i.jsx)(e.mn,{children:"1"})]}),(0,i.jsx)(e.mo,{separator:"true",children:","}),(0,i.jsx)(e.mi,{mathvariant:"normal",children:"."}),(0,i.jsx)(e.mi,{mathvariant:"normal",children:"."}),(0,i.jsx)(e.mi,{mathvariant:"normal",children:"."}),(0,i.jsx)(e.mo,{separator:"true",children:","}),(0,i.jsxs)(e.msub,{children:[(0,i.jsxs)(e.mover,{accent:"true",children:[(0,i.jsx)(e.mi,{children:"q"}),(0,i.jsx)(e.mo,{children:"\u02d9"})]}),(0,i.jsx)(e.mi,{children:"N"})]}),(0,i.jsx)(e.mo,{separator:"true",children:","}),(0,i.jsxs)(e.msub,{children:[(0,i.jsx)(e.mi,{children:"u"}),(0,i.jsx)(e.mn,{children:"1"})]}),(0,i.jsx)(e.mo,{separator:"true",children:","}),(0,i.jsx)(e.mi,{mathvariant:"normal",children:"."}),(0,i.jsx)(e.mi,{mathvariant:"normal",children:"."}),(0,i.jsx)(e.mi,{mathvariant:"normal",children:"."}),(0,i.jsx)(e.mo,{separator:"true",children:","}),(0,i.jsxs)(e.msub,{children:[(0,i.jsx)(e.mi,{children:"u"}),(0,i.jsx)(e.mi,{children:"N"})]}),(0,i.jsx)(e.mo,{separator:"true",children:","}),(0,i.jsx)(e.mi,{children:"T"}),(0,i.jsx)(e.mo,{stretchy:"false",children:"]"})]}),(0,i.jsx)(e.annotation,{encoding:"application/x-tex",children:"[q_1, q_2, ..., q_N, \\dot{q}_1, ..., \\dot{q}_N, u_1, ..., u_N, T]"})]})})}),(0,i.jsx)(e.span,{className:"katex-html","aria-hidden":"true",children:(0,i.jsxs)(e.span,{className:"base",children:[(0,i.jsx)(e.span,{className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,i.jsx)(e.span,{className:"mopen",children:"["}),(0,i.jsxs)(e.span,{className:"mord",children:[(0,i.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.03588em"},children:"q"}),(0,i.jsx)(e.span,{className:"msupsub",children:(0,i.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,i.jsxs)(e.span,{className:"vlist-r",children:[(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.3011em"},children:(0,i.jsxs)(e.span,{style:{top:"-2.55em",marginLeft:"-0.0359em",marginRight:"0.05em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,i.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,i.jsx)(e.span,{className:"mord mtight",children:"1"})})]})}),(0,i.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,i.jsx)(e.span,{className:"vlist-r",children:(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.15em"},children:(0,i.jsx)(e.span,{})})})]})})]}),(0,i.jsx)(e.span,{className:"mpunct",children:","}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.1667em"}}),(0,i.jsxs)(e.span,{className:"mord",children:[(0,i.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.03588em"},children:"q"}),(0,i.jsx)(e.span,{className:"msupsub",children:(0,i.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,i.jsxs)(e.span,{className:"vlist-r",children:[(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.3011em"},children:(0,i.jsxs)(e.span,{style:{top:"-2.55em",marginLeft:"-0.0359em",marginRight:"0.05em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,i.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,i.jsx)(e.span,{className:"mord mtight",children:"2"})})]})}),(0,i.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,i.jsx)(e.span,{className:"vlist-r",children:(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.15em"},children:(0,i.jsx)(e.span,{})})})]})})]}),(0,i.jsx)(e.span,{className:"mpunct",children:","}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.1667em"}}),(0,i.jsx)(e.span,{className:"mord",children:"..."}),(0,i.jsx)(e.span,{className:"mpunct",children:","}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.1667em"}}),(0,i.jsxs)(e.span,{className:"mord",children:[(0,i.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.03588em"},children:"q"}),(0,i.jsx)(e.span,{className:"msupsub",children:(0,i.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,i.jsxs)(e.span,{className:"vlist-r",children:[(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.3283em"},children:(0,i.jsxs)(e.span,{style:{top:"-2.55em",marginLeft:"-0.0359em",marginRight:"0.05em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,i.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,i.jsx)(e.span,{className:"mord mathnormal mtight",style:{marginRight:"0.10903em"},children:"N"})})]})}),(0,i.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,i.jsx)(e.span,{className:"vlist-r",children:(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.15em"},children:(0,i.jsx)(e.span,{})})})]})})]}),(0,i.jsx)(e.span,{className:"mpunct",children:","}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.1667em"}}),(0,i.jsxs)(e.span,{className:"mord",children:[(0,i.jsx)(e.span,{className:"mord accent",children:(0,i.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,i.jsxs)(e.span,{className:"vlist-r",children:[(0,i.jsxs)(e.span,{className:"vlist",style:{height:"0.6679em"},children:[(0,i.jsxs)(e.span,{style:{top:"-3em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"3em"}}),(0,i.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.03588em"},children:"q"})]}),(0,i.jsxs)(e.span,{style:{top:"-3em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"3em"}}),(0,i.jsx)(e.span,{className:"accent-body",style:{left:"-0.0556em"},children:(0,i.jsx)(e.span,{className:"mord",children:"\u02d9"})})]})]}),(0,i.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,i.jsx)(e.span,{className:"vlist-r",children:(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.1944em"},children:(0,i.jsx)(e.span,{})})})]})}),(0,i.jsx)(e.span,{className:"msupsub",children:(0,i.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,i.jsxs)(e.span,{className:"vlist-r",children:[(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.3011em"},children:(0,i.jsxs)(e.span,{style:{top:"-2.55em",marginLeft:"-0.0359em",marginRight:"0.05em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,i.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,i.jsx)(e.span,{className:"mord mtight",children:"1"})})]})}),(0,i.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,i.jsx)(e.span,{className:"vlist-r",children:(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.15em"},children:(0,i.jsx)(e.span,{})})})]})})]}),(0,i.jsx)(e.span,{className:"mpunct",children:","}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.1667em"}}),(0,i.jsx)(e.span,{className:"mord",children:"..."}),(0,i.jsx)(e.span,{className:"mpunct",children:","}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.1667em"}}),(0,i.jsxs)(e.span,{className:"mord",children:[(0,i.jsx)(e.span,{className:"mord accent",children:(0,i.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,i.jsxs)(e.span,{className:"vlist-r",children:[(0,i.jsxs)(e.span,{className:"vlist",style:{height:"0.6679em"},children:[(0,i.jsxs)(e.span,{style:{top:"-3em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"3em"}}),(0,i.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.03588em"},children:"q"})]}),(0,i.jsxs)(e.span,{style:{top:"-3em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"3em"}}),(0,i.jsx)(e.span,{className:"accent-body",style:{left:"-0.0556em"},children:(0,i.jsx)(e.span,{className:"mord",children:"\u02d9"})})]})]}),(0,i.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,i.jsx)(e.span,{className:"vlist-r",children:(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.1944em"},children:(0,i.jsx)(e.span,{})})})]})}),(0,i.jsx)(e.span,{className:"msupsub",children:(0,i.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,i.jsxs)(e.span,{className:"vlist-r",children:[(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.3283em"},children:(0,i.jsxs)(e.span,{style:{top:"-2.55em",marginLeft:"-0.0359em",marginRight:"0.05em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,i.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,i.jsx)(e.span,{className:"mord mathnormal mtight",style:{marginRight:"0.10903em"},children:"N"})})]})}),(0,i.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,i.jsx)(e.span,{className:"vlist-r",children:(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.15em"},children:(0,i.jsx)(e.span,{})})})]})})]}),(0,i.jsx)(e.span,{className:"mpunct",children:","}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.1667em"}}),(0,i.jsxs)(e.span,{className:"mord",children:[(0,i.jsx)(e.span,{className:"mord mathnormal",children:"u"}),(0,i.jsx)(e.span,{className:"msupsub",children:(0,i.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,i.jsxs)(e.span,{className:"vlist-r",children:[(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.3011em"},children:(0,i.jsxs)(e.span,{style:{top:"-2.55em",marginLeft:"0em",marginRight:"0.05em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,i.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,i.jsx)(e.span,{className:"mord mtight",children:"1"})})]})}),(0,i.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,i.jsx)(e.span,{className:"vlist-r",children:(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.15em"},children:(0,i.jsx)(e.span,{})})})]})})]}),(0,i.jsx)(e.span,{className:"mpunct",children:","}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.1667em"}}),(0,i.jsx)(e.span,{className:"mord",children:"..."}),(0,i.jsx)(e.span,{className:"mpunct",children:","}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.1667em"}}),(0,i.jsxs)(e.span,{className:"mord",children:[(0,i.jsx)(e.span,{className:"mord mathnormal",children:"u"}),(0,i.jsx)(e.span,{className:"msupsub",children:(0,i.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,i.jsxs)(e.span,{className:"vlist-r",children:[(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.3283em"},children:(0,i.jsxs)(e.span,{style:{top:"-2.55em",marginLeft:"0em",marginRight:"0.05em"},children:[(0,i.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,i.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,i.jsx)(e.span,{className:"mord mathnormal mtight",style:{marginRight:"0.10903em"},children:"N"})})]})}),(0,i.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,i.jsx)(e.span,{className:"vlist-r",children:(0,i.jsx)(e.span,{className:"vlist",style:{height:"0.15em"},children:(0,i.jsx)(e.span,{})})})]})})]}),(0,i.jsx)(e.span,{className:"mpunct",children:","}),(0,i.jsx)(e.span,{className:"mspace",style:{marginRight:"0.1667em"}}),(0,i.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.13889em"},children:"T"}),(0,i.jsx)(e.span,{className:"mclose",children:"]"})]})})]})]}),"\n",(0,i.jsx)(e.li,{children:"Enforce dynamics at collocation points"}),"\n",(0,i.jsx)(e.li,{children:"Use sparse optimization solvers"}),"\n"]}),"\n",(0,i.jsx)(e.h2,{id:"instructions",children:"Instructions"}),"\n",(0,i.jsx)(e.h3,{id:"step-1-define-the-problem-structure",children:"Step 1: Define the Problem Structure"}),"\n",(0,i.jsx)(e.p,{children:"Set up a simple trajectory optimization problem:"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-python",children:'import numpy as np\nfrom scipy.optimize import minimize, NonlinearConstraint\nimport matplotlib.pyplot as plt\n\nclass TrajectoryOptimizer:\n    """\n    Direct collocation trajectory optimizer for 2-DOF arm.\n    """\n\n    def __init__(self, n_joints=2, n_waypoints=20):\n        """\n        Initialize trajectory optimizer.\n\n        Args:\n            n_joints: Number of robot joints\n            n_waypoints: Number of discretization points\n        """\n        self.n_joints = n_joints\n        self.n_waypoints = n_waypoints\n\n        # Robot parameters\n        self.link_masses = [2.0, 1.5]  # kg\n        self.link_lengths = [0.5, 0.4]  # m\n        self.link_inertias = [0.042, 0.02]  # kg*m^2\n\n        # Limits\n        self.q_min = np.array([-np.pi, -np.pi])\n        self.q_max = np.array([np.pi, np.pi])\n        self.qd_max = np.array([5.0, 5.0])  # rad/s\n        self.u_max = np.array([50.0, 30.0])  # Nm\n\n        # Time bounds\n        self.T_min = 0.5  # seconds\n        self.T_max = 5.0\n\n    def pack_variables(self, q_traj, qd_traj, u_traj, T):\n        """Pack decision variables into single vector."""\n        return np.concatenate([\n            q_traj.flatten(),\n            qd_traj.flatten(),\n            u_traj.flatten(),\n            [T]\n        ])\n\n    def unpack_variables(self, x):\n        """Unpack decision variables from vector."""\n        n, N = self.n_joints, self.n_waypoints\n\n        idx = 0\n        q_traj = x[idx:idx + n*N].reshape(N, n)\n        idx += n*N\n\n        qd_traj = x[idx:idx + n*N].reshape(N, n)\n        idx += n*N\n\n        u_traj = x[idx:idx + n*N].reshape(N, n)\n        idx += n*N\n\n        T = x[idx]\n\n        return q_traj, qd_traj, u_traj, T\n\n# Create optimizer\nopt = TrajectoryOptimizer(n_joints=2, n_waypoints=20)\n\n# Test packing/unpacking\nq_test = np.random.randn(20, 2)\nqd_test = np.random.randn(20, 2)\nu_test = np.random.randn(20, 2)\nT_test = 2.0\n\nx = opt.pack_variables(q_test, qd_test, u_test, T_test)\nq_rec, qd_rec, u_rec, T_rec = opt.unpack_variables(x)\n\nprint(f"Total decision variables: {len(x)}")\nprint(f"Pack/unpack consistent: {np.allclose(q_test, q_rec)}")\n'})}),"\n",(0,i.jsx)("checkpoint",{children:(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.strong,{children:"Expected"}),": 121 decision variables (20",(0,i.jsx)(e.em,{children:"2 + 20"}),"2 + 20*2 + 1), pack/unpack returns True."]})}),"\n",(0,i.jsx)(e.h3,{id:"step-2-define-cost-function",children:"Step 2: Define Cost Function"}),"\n",(0,i.jsx)(e.p,{children:"Implement cost function for optimization:"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-python",children:"def compute_cost(self, x, weights={'time': 1.0, 'energy': 0.1, 'smoothness': 0.01}):\n    \"\"\"\n    Compute trajectory cost.\n\n    Cost = w_T * T + w_E * \u222bu\xb2dt + w_S * \u222b(du/dt)\xb2dt\n\n    Args:\n        x: Decision variable vector\n        weights: Dictionary of cost weights\n\n    Returns:\n        Total cost (scalar)\n    \"\"\"\n    q_traj, qd_traj, u_traj, T = self.unpack_variables(x)\n    N = self.n_waypoints\n    dt = T / (N - 1)\n\n    cost = 0.0\n\n    # Time cost\n    cost += weights['time'] * T\n\n    # Energy cost (sum of squared torques)\n    energy = np.sum(u_traj**2) * dt\n    cost += weights['energy'] * energy\n\n    # Smoothness cost (sum of squared torque derivatives)\n```python\n```python\n    if N > 1:\n"})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:"        du = np.diff(u_traj, axis=0) / dt\n        smoothness = np.sum(du**2) * dt\n        cost += weights['smoothness'] * smoothness\n\n    return cost\n\n# Add method to class\nTrajectoryOptimizer.compute_cost = compute_cost\n\n# Test cost computation\nq_init = np.linspace([0, 0], [1.5, 1.0], 20)\nqd_init = np.zeros((20, 2))\nu_init = np.zeros((20, 2))\nT_init = 2.0\n\nx_init = opt.pack_variables(q_init, qd_init, u_init, T_init)\ncost = opt.compute_cost(x_init)\nprint(f\"Initial cost: {cost:.4f}\")\n"})}),"\n",(0,i.jsx)("checkpoint",{children:(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.strong,{children:"Expected"}),": Cost value computed without errors."]})}),"\n",(0,i.jsx)(e.h3,{id:"step-3-implement-dynamics-constraints",children:"Step 3: Implement Dynamics Constraints"}),"\n",(0,i.jsx)(e.p,{children:"Enforce robot dynamics using collocation:"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-python",children:'def compute_dynamics_residual(self, q, qd, qdd, u):\n    """\n    Compute dynamics residual: M*qdd + C*qd + g - u\n\n    For 2-DOF arm with simplified dynamics.\n    """\n    m1, m2 = self.link_masses\n    l1, l2 = self.link_lengths\n    lc1, lc2 = l1/2, l2/2\n    I1, I2 = self.link_inertias\n    g = 9.81\n\n    q1, q2 = q\n    qd1, qd2 = qd\n\n    # Mass matrix elements\n    M11 = m1*lc1**2 + I1 + m2*(l1**2 + lc2**2 + 2*l1*lc2*np.cos(q2)) + I2\n    M12 = m2*(lc2**2 + l1*lc2*np.cos(q2)) + I2\n    M21 = M12\n    M22 = m2*lc2**2 + I2\n\n    M = np.array([[M11, M12], [M21, M22]])\n\n    # Coriolis terms\n    h = -m2*l1*lc2*np.sin(q2)\n    C = np.array([\n        [h*qd2, h*(qd1 + qd2)],\n        [-h*qd1, 0]\n    ])\n\n    # Gravity\n    g_vec = np.array([\n        (m1*lc1 + m2*l1)*g*np.cos(q1) + m2*lc2*g*np.cos(q1 + q2),\n        m2*lc2*g*np.cos(q1 + q2)\n    ])\n\n    # Dynamics residual\n    residual = M @ qdd + C @ qd + g_vec - u\n\n    return residual\n\ndef dynamics_constraints(self, x):\n    """\n    Compute all dynamics constraint violations.\n\n    Uses trapezoidal collocation:\n    q[k+1] = q[k] + dt/2 * (qd[k] + qd[k+1])\n    qd[k+1] = qd[k] + dt/2 * (qdd[k] + qdd[k+1])\n\n    Returns:\n        Array of constraint violations (should be zero)\n    """\n    q_traj, qd_traj, u_traj, T = self.unpack_variables(x)\n    N = self.n_waypoints\n    dt = T / (N - 1)\n\n    constraints = []\n\n    for k in range(N - 1):\n        q_k, q_kp1 = q_traj[k], q_traj[k+1]\n        qd_k, qd_kp1 = qd_traj[k], qd_traj[k+1]\n        u_k, u_kp1 = u_traj[k], u_traj[k+1]\n\n        # Estimate accelerations from dynamics\n        # M*qdd = u - C*qd - g\n        qdd_k = self._compute_acceleration(q_k, qd_k, u_k)\n        qdd_kp1 = self._compute_acceleration(q_kp1, qd_kp1, u_kp1)\n\n        # Trapezoidal integration constraints\n        # Position: q[k+1] - q[k] - dt/2*(qd[k] + qd[k+1]) = 0\n        pos_defect = q_kp1 - q_k - dt/2 * (qd_k + qd_kp1)\n\n        # Velocity: qd[k+1] - qd[k] - dt/2*(qdd[k] + qdd[k+1]) = 0\n        vel_defect = qd_kp1 - qd_k - dt/2 * (qdd_k + qdd_kp1)\n\n        constraints.extend(pos_defect.tolist())\n        constraints.extend(vel_defect.tolist())\n\n    return np.array(constraints)\n\ndef _compute_acceleration(self, q, qd, u):\n    """Compute acceleration from inverse dynamics."""\n    m1, m2 = self.link_masses\n    l1, l2 = self.link_lengths\n    lc1, lc2 = l1/2, l2/2\n    I1, I2 = self.link_inertias\n    g = 9.81\n\n    q1, q2 = q\n    qd1, qd2 = qd\n\n    # Mass matrix\n    M11 = m1*lc1**2 + I1 + m2*(l1**2 + lc2**2 + 2*l1*lc2*np.cos(q2)) + I2\n    M12 = m2*(lc2**2 + l1*lc2*np.cos(q2)) + I2\n    M22 = m2*lc2**2 + I2\n    M = np.array([[M11, M12], [M12, M22]])\n\n    # Coriolis\n    h = -m2*l1*lc2*np.sin(q2)\n    C_qd = np.array([\n        h*qd2*(2*qd1 + qd2),\n        -h*qd1*qd1\n    ])\n\n    # Gravity\n    g_vec = np.array([\n        (m1*lc1 + m2*l1)*g*np.cos(q1) + m2*lc2*g*np.cos(q1 + q2),\n        m2*lc2*g*np.cos(q1 + q2)\n    ])\n\n    # Solve for acceleration\n    qdd = np.linalg.solve(M, u - C_qd - g_vec)\n\n    return qdd\n\n# Add methods to class\nTrajectoryOptimizer.compute_dynamics_residual = compute_dynamics_residual\nTrajectoryOptimizer.dynamics_constraints = dynamics_constraints\nTrajectoryOptimizer._compute_acceleration = _compute_acceleration\n\n# Test dynamics constraints\nconstraints = opt.dynamics_constraints(x_init)\nprint(f"Number of dynamics constraints: {len(constraints)}")\nprint(f"Initial constraint violation (should be large): {np.linalg.norm(constraints):.4f}")\n'})}),"\n",(0,i.jsx)("checkpoint",{children:(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.strong,{children:"Expected"}),": 76 dynamics constraints (19 intervals \xd7 4 defects), large initial violation."]})}),"\n",(0,i.jsx)(e.h3,{id:"step-4-boundary-and-path-constraints",children:"Step 4: Boundary and Path Constraints"}),"\n",(0,i.jsx)(e.p,{children:"Add start/end conditions and limits:"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-python",children:'def boundary_constraints(self, x, q_start, q_goal):\n    """\n    Boundary condition constraints.\n\n    q(0) = q_start, q(T) = q_goal\n    qd(0) = 0, qd(T) = 0 (start and end at rest)\n    """\n    q_traj, qd_traj, u_traj, T = self.unpack_variables(x)\n\n    constraints = []\n\n    # Initial position and velocity\n    constraints.extend((q_traj[0] - q_start).tolist())\n    constraints.extend(qd_traj[0].tolist())\n\n    # Final position and velocity\n    constraints.extend((q_traj[-1] - q_goal).tolist())\n    constraints.extend(qd_traj[-1].tolist())\n\n    return np.array(constraints)\n\ndef get_bounds(self, q_start, q_goal):\n    """\n    Get variable bounds for optimization.\n\n    Returns:\n        List of (lower, upper) bounds for each variable\n    """\n    N = self.n_waypoints\n    n = self.n_joints\n\n    bounds = []\n\n    # Position bounds\n    for _ in range(N):\n        for j in range(n):\n            bounds.append((self.q_min[j], self.q_max[j]))\n\n    # Velocity bounds\n    for _ in range(N):\n        for j in range(n):\n            bounds.append((-self.qd_max[j], self.qd_max[j]))\n\n    # Control bounds\n    for _ in range(N):\n        for j in range(n):\n            bounds.append((-self.u_max[j], self.u_max[j]))\n\n    # Time bounds\n    bounds.append((self.T_min, self.T_max))\n\n    return bounds\n\nTrajectoryOptimizer.boundary_constraints = boundary_constraints\nTrajectoryOptimizer.get_bounds = get_bounds\n'})}),"\n",(0,i.jsx)("checkpoint",{children:(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.strong,{children:"Expected"}),": Boundary constraint function returns 8 constraints (4 initial + 4 final)."]})}),"\n",(0,i.jsx)(e.h3,{id:"step-5-solve-the-optimization",children:"Step 5: Solve the Optimization"}),"\n",(0,i.jsx)(e.p,{children:"Put it all together and solve:"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-python",children:"def optimize(self, q_start, q_goal, T_init=2.0, verbose=True):\n    \"\"\"\n    Optimize trajectory from q_start to q_goal.\n\n    Args:\n        q_start: Initial configuration\n        q_goal: Goal configuration\n        T_init: Initial guess for duration\n        verbose: Print progress\n\n    Returns:\n        Optimized trajectory dictionary\n    \"\"\"\n    N = self.n_waypoints\n    n = self.n_joints\n\n    # Initialize with linear interpolation\n    q_init = np.linspace(q_start, q_goal, N)\n    qd_init = np.zeros((N, n))\n\n    # Initialize controls to counteract gravity at each point\n    u_init = np.zeros((N, n))\n    for i in range(N):\n        # Simple gravity compensation\n        u_init[i] = self._gravity_compensation(q_init[i])\n\n    x0 = self.pack_variables(q_init, qd_init, u_init, T_init)\n\n    # Cost function\n    def cost_fn(x):\n        return self.compute_cost(x)\n\n    # Constraints\n    def dynamics_eq(x):\n        return self.dynamics_constraints(x)\n\n    def boundary_eq(x):\n        return self.boundary_constraints(x, q_start, q_goal)\n\n    dynamics_constraint = NonlinearConstraint(dynamics_eq, 0, 0)\n    boundary_constraint = NonlinearConstraint(boundary_eq, 0, 0)\n\n    # Bounds\n    bounds = self.get_bounds(q_start, q_goal)\n\n    # Solve\n    if verbose:\n        print(\"Starting optimization...\")\n        print(f\"  Variables: {len(x0)}\")\n        print(f\"  Dynamics constraints: {len(dynamics_eq(x0))}\")\n        print(f\"  Boundary constraints: {len(boundary_eq(x0))}\")\n\n    result = minimize(\n        cost_fn,\n        x0,\n        method='SLSQP',\n        bounds=bounds,\n        constraints=[\n            {'type': 'eq', 'fun': dynamics_eq},\n            {'type': 'eq', 'fun': boundary_eq}\n        ],\n        options={'maxiter': 500, 'disp': verbose}\n    )\n\n    if verbose:\n        print(f\"\\nOptimization {'succeeded' if result.success else 'failed'}\")\n        print(f\"Final cost: {result.fun:.4f}\")\n\n    # Unpack result\n    q_opt, qd_opt, u_opt, T_opt = self.unpack_variables(result.x)\n\n    return {\n        'q': q_opt,\n        'qd': qd_opt,\n        'u': u_opt,\n        'T': T_opt,\n        'success': result.success,\n        'cost': result.fun,\n        'time_vector': np.linspace(0, T_opt, N)\n    }\n\ndef _gravity_compensation(self, q):\n    \"\"\"Compute gravity compensation torque.\"\"\"\n    m1, m2 = self.link_masses\n    l1 = self.link_lengths[0]\n    lc1, lc2 = l1/2, self.link_lengths[1]/2\n    g = 9.81\n\n    q1, q2 = q\n\n    tau1 = (m1*lc1 + m2*l1)*g*np.cos(q1) + m2*lc2*g*np.cos(q1 + q2)\n    tau2 = m2*lc2*g*np.cos(q1 + q2)\n\n    return np.array([tau1, tau2])\n\nTrajectoryOptimizer.optimize = optimize\nTrajectoryOptimizer._gravity_compensation = _gravity_compensation\n\n# Run optimization\nq_start = np.array([0.0, 0.0])\nq_goal = np.array([np.pi/2, -np.pi/4])\n\nresult = opt.optimize(q_start, q_goal, T_init=2.0)\n\nprint(f\"\\nOptimized duration: {result['T']:.3f} seconds\")\nprint(f\"Final position error: {np.linalg.norm(result['q'][-1] - q_goal):.6f}\")\n"})}),"\n",(0,i.jsx)("checkpoint",{children:(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.strong,{children:"Expected"}),": Optimization converges, final position error near zero."]})}),"\n",(0,i.jsx)(e.h3,{id:"step-6-visualize-results",children:"Step 6: Visualize Results"}),"\n",(0,i.jsx)(e.p,{children:"Create comprehensive visualization:"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-python",children:"def visualize_trajectory(result, opt):\n    \"\"\"Visualize optimized trajectory.\"\"\"\n    fig, axes = plt.subplots(2, 2, figsize=(14, 10))\n\n    t = result['time_vector']\n    q = result['q']\n    qd = result['qd']\n    u = result['u']\n\n    # Joint positions\n    axes[0, 0].plot(t, np.degrees(q[:, 0]), 'b-', linewidth=2, label='Joint 1')\n    axes[0, 0].plot(t, np.degrees(q[:, 1]), 'r-', linewidth=2, label='Joint 2')\n    axes[0, 0].set_xlabel('Time (s)')\n    axes[0, 0].set_ylabel('Position (deg)')\n    axes[0, 0].set_title('Joint Positions')\n    axes[0, 0].legend()\n    axes[0, 0].grid(True)\n\n    # Joint velocities\n    axes[0, 1].plot(t, np.degrees(qd[:, 0]), 'b-', linewidth=2, label='Joint 1')\n    axes[0, 1].plot(t, np.degrees(qd[:, 1]), 'r-', linewidth=2, label='Joint 2')\n    axes[0, 1].axhline(y=np.degrees(opt.qd_max[0]), color='k', linestyle='--', alpha=0.5)\n    axes[0, 1].axhline(y=-np.degrees(opt.qd_max[0]), color='k', linestyle='--', alpha=0.5)\n    axes[0, 1].set_xlabel('Time (s)')\n    axes[0, 1].set_ylabel('Velocity (deg/s)')\n    axes[0, 1].set_title('Joint Velocities')\n    axes[0, 1].legend()\n    axes[0, 1].grid(True)\n\n    # Control torques\n    axes[1, 0].plot(t, u[:, 0], 'b-', linewidth=2, label='Joint 1')\n    axes[1, 0].plot(t, u[:, 1], 'r-', linewidth=2, label='Joint 2')\n    axes[1, 0].axhline(y=opt.u_max[0], color='b', linestyle='--', alpha=0.5)\n    axes[1, 0].axhline(y=-opt.u_max[0], color='b', linestyle='--', alpha=0.5)\n    axes[1, 0].axhline(y=opt.u_max[1], color='r', linestyle='--', alpha=0.5)\n    axes[1, 0].axhline(y=-opt.u_max[1], color='r', linestyle='--', alpha=0.5)\n    axes[1, 0].set_xlabel('Time (s)')\n    axes[1, 0].set_ylabel('Torque (Nm)')\n    axes[1, 0].set_title('Control Torques')\n    axes[1, 0].legend()\n    axes[1, 0].grid(True)\n\n    # Workspace path\n    ax = axes[1, 1]\n    l1, l2 = opt.link_lengths\n\n    for i in range(len(q)):\n        alpha = 0.2 + 0.8 * i / len(q)\n        x1 = l1 * np.cos(q[i, 0])\n        y1 = l1 * np.sin(q[i, 0])\n        x2 = x1 + l2 * np.cos(q[i, 0] + q[i, 1])\n        y2 = y1 + l2 * np.sin(q[i, 0] + q[i, 1])\n\n        ax.plot([0, x1, x2], [0, y1, y2], 'b-', alpha=alpha, linewidth=1)\n\n    # Start and end\n    x1_s = l1 * np.cos(q[0, 0])\n    y1_s = l1 * np.sin(q[0, 0])\n    x2_s = x1_s + l2 * np.cos(q[0, 0] + q[0, 1])\n    y2_s = y1_s + l2 * np.sin(q[0, 0] + q[0, 1])\n    ax.plot([0, x1_s, x2_s], [0, y1_s, y2_s], 'g-', linewidth=3, label='Start')\n\n    x1_e = l1 * np.cos(q[-1, 0])\n    y1_e = l1 * np.sin(q[-1, 0])\n    x2_e = x1_e + l2 * np.cos(q[-1, 0] + q[-1, 1])\n    y2_e = y1_e + l2 * np.sin(q[-1, 0] + q[-1, 1])\n    ax.plot([0, x1_e, x2_e], [0, y1_e, y2_e], 'r-', linewidth=3, label='End')\n\n    ax.set_xlabel('X (m)')\n    ax.set_ylabel('Y (m)')\n    ax.set_title('Workspace Trajectory')\n    ax.set_aspect('equal')\n    ax.legend()\n    ax.grid(True)\n\n    plt.tight_layout()\n    plt.savefig('trajectory_optimization.png', dpi=150)\n    plt.show()\n\nvisualize_trajectory(result, opt)\n"})}),"\n",(0,i.jsx)("checkpoint",{children:(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.strong,{children:"Expected"}),": Four-panel plot showing smooth position, velocity, torque profiles and workspace motion."]})}),"\n",(0,i.jsx)(e.h2,{id:"expected-outcomes",children:"Expected Outcomes"}),"\n",(0,i.jsx)(e.p,{children:"After completing this lab, you should have:"}),"\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.strong,{children:"Code artifacts"}),":"]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"trajectory_optimizer.py"}),": Complete direct collocation optimizer"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"arm_dynamics.py"}),": 2-DOF arm dynamics functions"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.strong,{children:"Visual outputs"}),":"]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"trajectory_optimization.png"}),": Multi-panel trajectory visualization"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.strong,{children:"Understanding"}),":"]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"Trajectory optimization formulation"}),"\n",(0,i.jsx)(e.li,{children:"Direct collocation method"}),"\n",(0,i.jsx)(e.li,{children:"Trade-offs between time, energy, and smoothness"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(e.h2,{id:"rubric",children:"Rubric"}),"\n",(0,i.jsxs)(e.table,{children:[(0,i.jsx)(e.thead,{children:(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.th,{children:"Criterion"}),(0,i.jsx)(e.th,{children:"Points"}),(0,i.jsx)(e.th,{children:"Description"})]})}),(0,i.jsxs)(e.tbody,{children:[(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"Problem Formulation"}),(0,i.jsx)(e.td,{children:"20"}),(0,i.jsx)(e.td,{children:"Correct variable packing and cost function"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"Dynamics Constraints"}),(0,i.jsx)(e.td,{children:"30"}),(0,i.jsx)(e.td,{children:"Proper collocation constraints implementation"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"Boundary Conditions"}),(0,i.jsx)(e.td,{children:"15"}),(0,i.jsx)(e.td,{children:"Start/end position and velocity constraints"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"Optimization"}),(0,i.jsx)(e.td,{children:"20"}),(0,i.jsx)(e.td,{children:"Successful solution finding"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"Visualization"}),(0,i.jsx)(e.td,{children:"15"}),(0,i.jsx)(e.td,{children:"Clear, informative trajectory plots"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:(0,i.jsx)(e.strong,{children:"Total"})}),(0,i.jsx)(e.td,{children:(0,i.jsx)(e.strong,{children:"100"})}),(0,i.jsx)(e.td,{})]})]})]}),"\n",(0,i.jsx)(e.h2,{id:"common-errors",children:"Common Errors"}),"\n",(0,i.jsxs)("troubleshooting",{children:[(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.strong,{children:"Error"}),": Optimization fails to converge\n",(0,i.jsx)(e.strong,{children:"Solution"}),": Improve initial guess, reduce problem size, check constraint scaling."]}),(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.strong,{children:"Error"}),": Dynamics constraints violated\n",(0,i.jsx)(e.strong,{children:"Solution"}),": Verify dynamics equations, check M matrix conditioning."]}),(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.strong,{children:"Error"}),": Solution violates bounds\n",(0,i.jsx)(e.strong,{children:"Solution"}),": Ensure bounds are properly formatted, check for infeasible problem."]})]}),"\n",(0,i.jsx)(e.h2,{id:"extensions",children:"Extensions"}),"\n",(0,i.jsx)(e.p,{children:"For advanced students:"}),"\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.strong,{children:"Obstacle Avoidance"}),": Add signed distance constraints"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.strong,{children:"Multiple Phases"}),": Handle contact/non-contact phases"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.strong,{children:"Warm Starting"}),": Use previous solution to speed up replanning"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.strong,{children:"Shooting Methods"}),": Implement single/multiple shooting alternatives"]}),"\n"]}),"\n",(0,i.jsx)(e.h2,{id:"related-content",children:"Related Content"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.strong,{children:"Theory"}),": Module 06 theory.md, Section 6.5 (Trajectory Optimization)"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.strong,{children:"Previous Labs"}),": Lab 06-01 (RRT), Lab 06-02 (A*)"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.strong,{children:"Application"}),": See Figure AI case study for real-world trajectory optimization"]}),"\n"]})]})}function o(s={}){const{wrapper:e}={...(0,t.R)(),...s.components};return e?(0,i.jsx)(e,{...s,children:(0,i.jsx)(d,{...s})}):d(s)}},8453(s,e,n){n.d(e,{R:()=>l,x:()=>r});var a=n(6540);const i={},t=a.createContext(i);function l(s){const e=a.useContext(t);return a.useMemo(function(){return"function"==typeof s?s(e):{...e,...s}},[e,s])}function r(s){let e;return e=s.disableParentContext?"function"==typeof s.components?s.components(i):s.components||i:l(s.components),a.createElement(t.Provider,{value:e},s.children)}}}]);